<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>漏洞银行逆向教程3 | K's House</title><meta name="description" content="漏洞银行逆向教程3"><meta name="keywords" content="逆向,漏洞银行"><meta name="author" content="kabeor"><meta name="copyright" content="kabeor"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="漏洞银行逆向教程3"><meta name="twitter:description" content="漏洞银行逆向教程3"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta property="og:type" content="article"><meta property="og:title" content="漏洞银行逆向教程3"><meta property="og:url" content="https://kabeor.github.io/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B3/"><meta property="og:site_name" content="K's House"><meta property="og:description" content="漏洞银行逆向教程3"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://kabeor.github.io/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B3/"><link rel="prev" title="漏洞银行逆向教程2" href="https://kabeor.github.io/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B2/"><link rel="next" title="漏洞银行逆向教程4" href="https://kabeor.github.io/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B4/"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-113413523-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">K's House</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://kabeor.cn/img/avatarme.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">125</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">67</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">30</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#标志寄存器"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">标志寄存器</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#ZF标志"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">ZF标志</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#PF标志"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">PF标志</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#SF标志"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">SF标志</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#OF标志"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">OF标志</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#adc"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">adc</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#sbb"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">sbb</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#cmp指令"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">cmp指令</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#TEST命令"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">TEST命令</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#80386寄存器组"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text">80386寄存器组</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#一、通用寄存器"><span class="toc_mobile_items-number">5.1.1.</span> <span class="toc_mobile_items-text">一、通用寄存器</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#二、段寄存器"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">二、段寄存器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#三、指令指针寄存器和标志寄存器"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text">三、指令指针寄存器和标志寄存器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#四、系统地址寄存器"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text">四、系统地址寄存器</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#实模式"><span class="toc_mobile_items-number"></span> <span class="toc_mobile_items-text">实模式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#保护模式："><span class="toc_mobile_items-number">0.1.</span> <span class="toc_mobile_items-text">保护模式：</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#标志寄存器"><span class="toc-number">1.</span> <span class="toc-text">标志寄存器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ZF标志"><span class="toc-number">1.1.</span> <span class="toc-text">ZF标志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PF标志"><span class="toc-number">1.2.</span> <span class="toc-text">PF标志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SF标志"><span class="toc-number">1.3.</span> <span class="toc-text">SF标志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OF标志"><span class="toc-number">1.4.</span> <span class="toc-text">OF标志</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#adc"><span class="toc-number">2.</span> <span class="toc-text">adc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sbb"><span class="toc-number">3.</span> <span class="toc-text">sbb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmp指令"><span class="toc-number">4.</span> <span class="toc-text">cmp指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TEST命令"><span class="toc-number">5.</span> <span class="toc-text">TEST命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#80386寄存器组"><span class="toc-number">5.1.</span> <span class="toc-text">80386寄存器组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#一、通用寄存器"><span class="toc-number">5.1.1.</span> <span class="toc-text">一、通用寄存器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、段寄存器"><span class="toc-number">6.</span> <span class="toc-text">二、段寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、指令指针寄存器和标志寄存器"><span class="toc-number">7.</span> <span class="toc-text">三、指令指针寄存器和标志寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、系统地址寄存器"><span class="toc-number">8.</span> <span class="toc-text">四、系统地址寄存器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#实模式"><span class="toc-number"></span> <span class="toc-text">实模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#保护模式："><span class="toc-number">0.1.</span> <span class="toc-text">保护模式：</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png)"><div id="post-info"><div id="post-title"><div class="posttitle">漏洞银行逆向教程3</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2018-02-04<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-16</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%B1%87%E7%BC%96/">汇编</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%B1%87%E7%BC%96/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B/">漏洞银行逆向教程</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4.6k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 14 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B3/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B3/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="标志寄存器"><a href="#标志寄存器" class="headerlink" title="标志寄存器"></a>标志寄存器</h2><p>是一个16位的存放条件标志、控制标志寄存器，主要用于反映处理器的状态和ALU运算结果的某些特征及控制指令的执行。</p>
<p><a href="https://i.loli.net/2017/12/19/5a3866bc10640.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="36fbbb3da673e2c9444a194c929333e0.png" class="fancybox"><img alt="36fbbb3da673e2c9444a194c929333e0.png" title="36fbbb3da673e2c9444a194c929333e0.png" data-src="https://i.loli.net/2017/12/19/5a3866bc10640.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3866bd52813.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="87188f5e5b3a0af629a40af69d3cd861.png" class="fancybox"><img alt="87188f5e5b3a0af629a40af69d3cd861.png" title="87188f5e5b3a0af629a40af69d3cd861.png" data-src="https://i.loli.net/2017/12/19/5a3866bd52813.png" class="lazyload"></a></p>
<p><a href="https://i.loli.net/2017/12/19/5a3866bed85bb.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="53ad6f3b606211295cc0a5bc297e8829.png" class="fancybox"><img alt="53ad6f3b606211295cc0a5bc297e8829.png" title="53ad6f3b606211295cc0a5bc297e8829.png" data-src="https://i.loli.net/2017/12/19/5a3866bed85bb.png" class="lazyload"></a></p>
<p>各标志在标志寄存器中的位置</p>
<p>条件标志：</p>
<ul>
<li><p>进位标志：用于反映运算是否产生进位或借位。如果运算结果的最高位产生一个进位或借位，则CF置1，否则置0。运算结果的最高位包括字操作的第15位和字节操作的第7位。移位指令也会将<em>操作数</em>的最高位或最低位移入CF。</p>
</li>
<li><p>奇偶标志：用于反映运算结果低8位中“1”的个数。“1”的个数为偶数，则PF置1，否则置0。</p>
</li>
<li><p><a href="https://baike.baidu.com/item/%E8%BE%85%E5%8A%A9%E8%BF%9B%E4%BD%8D%E6%A0%87%E5%BF%97" target="_blank" rel="noopener">辅助进位标志</a>：算数操作结果的第三位（从0开始计数）如果产生了进位或者借位则将其置为1，否则置为0，常在BCD(binary-codedecimal)算术运算中被使用。</p>
</li>
<li><p>零标志：用于判断结果是否为0。运算结果0，ZF置1，否则置0。</p>
</li>
<li><p>符号标志：用于反映运算结果的符号，运算结果为负，SF置1，否则置0。因为<em>有符号数</em>采用补码的形式表示，所以SF与运算结果的最高位相同。</p>
</li>
<li><p>溢出标志：反映有符号数加减运算是否溢出。如果运算结果超过了8位或者16位有符号数的表示范围，则OF置1，否则置0。</p>
</li>
<li><p>控制标志：</p>
</li>
<li><p>跟踪标志：当TF被设置位1时，CPU进入单步模式，所谓单步模式就是CPU在每执行一步指令后都产生一个单步中断。主要用于程序的调试。8086/8088中没有专门用来置位和清零TF的命令，需要用其他办法。</p>
</li>
<li><p>中断标志：决定CPU是否响应外部可屏蔽<em>中断请求</em>。IF为1时，CPU允许响应外部的可屏蔽中断请求。</p>
</li>
<li><p>方向标志：决定串操作指令执行时有关指针寄存器调整方向。当DF为1时，串操作指令按递减方式改变有关<em>存储器</em>指针值，每次操作后使SI、DI递减。</p>
</li>
</ul>
<h3 id="ZF标志"><a href="#ZF标志" class="headerlink" title="ZF标志"></a>ZF标志</h3><p><a href="https://i.loli.net/2017/12/19/5a3868ef2a981.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ca2d20ee5f093b6db89a1a9d45766815.png" class="fancybox"><img alt="ca2d20ee5f093b6db89a1a9d45766815.png" title="ca2d20ee5f093b6db89a1a9d45766815.png" data-src="https://i.loli.net/2017/12/19/5a3868ef2a981.png" class="lazyload"></a></p>
<h3 id="PF标志"><a href="#PF标志" class="headerlink" title="PF标志"></a>PF标志</h3><p><a href="https://i.loli.net/2017/12/19/5a38691768414.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ffe582ef099e61015c6549937eddb20a.png" class="fancybox"><img alt="ffe582ef099e61015c6549937eddb20a.png" title="ffe582ef099e61015c6549937eddb20a.png" data-src="https://i.loli.net/2017/12/19/5a38691768414.png" class="lazyload"></a></p>
<h3 id="SF标志"><a href="#SF标志" class="headerlink" title="SF标志"></a>SF标志</h3><p><a href="https://i.loli.net/2017/12/19/5a386920eeba5.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="a33a3e8eaa2b3a58833971ebf3ab33cb.png" class="fancybox"><img alt="a33a3e8eaa2b3a58833971ebf3ab33cb.png" title="a33a3e8eaa2b3a58833971ebf3ab33cb.png" data-src="https://i.loli.net/2017/12/19/5a386920eeba5.png" class="lazyload"></a></p>
<h3 id="OF标志"><a href="#OF标志" class="headerlink" title="OF标志"></a>OF标志</h3><p><a href="https://i.loli.net/2017/12/19/5a3869308cde5.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="5f9609726f77437178c0354a282de0e3.png" class="fancybox"><img alt="5f9609726f77437178c0354a282de0e3.png" title="5f9609726f77437178c0354a282de0e3.png" data-src="https://i.loli.net/2017/12/19/5a3869308cde5.png" class="lazyload"></a></p>
<h2 id="adc"><a href="#adc" class="headerlink" title="adc"></a>adc</h2><p><a href="https://i.loli.net/2017/12/19/5a3869365dacb.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ffd4acf6f6e4707500e54b6d31d8af07.png" class="fancybox"><img alt="ffd4acf6f6e4707500e54b6d31d8af07.png" title="ffd4acf6f6e4707500e54b6d31d8af07.png" data-src="https://i.loli.net/2017/12/19/5a3869365dacb.png" class="lazyload"></a></p>
<h2 id="sbb"><a href="#sbb" class="headerlink" title="sbb"></a>sbb</h2><p><a href="https://i.loli.net/2017/12/19/5a38693a2d2a6.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="47e40b9a5eea33266fe79ff92cd11266.png" class="fancybox"><img alt="47e40b9a5eea33266fe79ff92cd11266.png" title="47e40b9a5eea33266fe79ff92cd11266.png" data-src="https://i.loli.net/2017/12/19/5a38693a2d2a6.png" class="lazyload"></a></p>
<h2 id="cmp指令"><a href="#cmp指令" class="headerlink" title="cmp指令"></a>cmp指令</h2><p><a href="https://i.loli.net/2017/12/19/5a38693da8021.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="16d5aee2eac343bc9ac5e236d7897726.png" class="fancybox"><img alt="16d5aee2eac343bc9ac5e236d7897726.png" title="16d5aee2eac343bc9ac5e236d7897726.png" data-src="https://i.loli.net/2017/12/19/5a38693da8021.png" class="lazyload"></a></p>
<p><a href="https://i.loli.net/2017/12/19/5a386940293ff.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="8baf906315fa0c7f8b5a99fbe5284d2b.png" class="fancybox"><img alt="8baf906315fa0c7f8b5a99fbe5284d2b.png" title="8baf906315fa0c7f8b5a99fbe5284d2b.png" data-src="https://i.loli.net/2017/12/19/5a386940293ff.png" class="lazyload"></a></p>
<h2 id="TEST命令"><a href="#TEST命令" class="headerlink" title="TEST命令"></a>TEST命令</h2><p><a href="https://i.loli.net/2017/12/19/5a386ac5e71cf.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="9f0c42b96647eb58a5f646a3bf982a4c.png" class="fancybox"><img alt="9f0c42b96647eb58a5f646a3bf982a4c.png" title="9f0c42b96647eb58a5f646a3bf982a4c.png" data-src="https://i.loli.net/2017/12/19/5a386ac5e71cf.png" class="lazyload"></a></p>
<h3 id="80386寄存器组"><a href="#80386寄存器组" class="headerlink" title="80386寄存器组"></a>80386寄存器组</h3><p><a href="https://i.loli.net/2017/12/19/5a386ac807f28.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="5865d3eef8437cc4dba05130d5b99afe.png" class="fancybox"><img alt="5865d3eef8437cc4dba05130d5b99afe.png" title="5865d3eef8437cc4dba05130d5b99afe.png" data-src="https://i.loli.net/2017/12/19/5a386ac807f28.png" class="lazyload"></a></p>
<h4 id="一、通用寄存器"><a href="#一、通用寄存器" class="headerlink" title="一、通用寄存器"></a>一、通用寄存器</h4><p><a href="https://i.loli.net/2017/12/19/5a386ac99176a.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="a71d2298fb0a47fce0bc07ef6fbb05dd.png" class="fancybox"><img alt="a71d2298fb0a47fce0bc07ef6fbb05dd.png" title="a71d2298fb0a47fce0bc07ef6fbb05dd.png" data-src="https://i.loli.net/2017/12/19/5a386ac99176a.png" class="lazyload"></a></p>
<p>一组八个通用寄存器是对8086/80286通用寄存器的32位扩展，其用法与在8086/80286中相似，支持8位、16位、32位操作，进行32位操作是，寄存器名称前面冠以“E”。</p>
<p>这八个寄存器的名称如下：EAX（累加器）、EBX（基址）、ECX（计数）、EDX（数据）、ESP（栈指针）、EBP（基址指针）、ESI（源变址）、EDI（目的变址）。</p>
<h2 id="二、段寄存器"><a href="#二、段寄存器" class="headerlink" title="二、段寄存器"></a>二、段寄存器</h2><p><a href="https://i.loli.net/2017/12/19/5a386ad0f22ce.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="975d9b58d813381005c96a9d1df68fab.png" class="fancybox"><img alt="975d9b58d813381005c96a9d1df68fab.png" title="975d9b58d813381005c96a9d1df68fab.png" data-src="https://i.loli.net/2017/12/19/5a386ad0f22ce.png" class="lazyload"></a></p>
<p><a href="https://i.loli.net/2017/12/19/5a386ad4335c8.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="3f785fc97c3c6e46c8502f6941b4bd97.png" class="fancybox"><img alt="3f785fc97c3c6e46c8502f6941b4bd97.png" title="3f785fc97c3c6e46c8502f6941b4bd97.png" data-src="https://i.loli.net/2017/12/19/5a386ad4335c8.png" class="lazyload"></a></p>
<p>80386比8086/80286增加了两个段寄存器FS、GS。</p>
<pre><code>除CS支持代码段，SS支持堆栈段外，程序员可以利用其它的所有段寄存器支持数据段。</code></pre><p>每个段寄存器对应这一个64位高速缓存器（有些资料中说有96位，但只使用其中的64位），这在8086中是没有的（在80286中为48位）。</p>
<h2 id="三、指令指针寄存器和标志寄存器"><a href="#三、指令指针寄存器和标志寄存器" class="headerlink" title="三、指令指针寄存器和标志寄存器"></a>三、指令指针寄存器和标志寄存器</h2><p>指令寄存器EIP是对8086/80286指令指针寄存器的32位扩展，它包含着待执行指令的32位偏移量，该值总是相对CS所代表的段基址而言的。</p>
<p>标志寄存器也是对8086/80286标志寄存器的32位扩展，其定义如下（这张图截自Intel关于IA32架构的最新文档）：</p>
<p><a href="https://i.loli.net/2017/12/19/5a386ad663a0f.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="e6e3d0563758721df9c7334caa288eba.jpg" class="fancybox"><img alt="e6e3d0563758721df9c7334caa288eba.jpg" title="e6e3d0563758721df9c7334caa288eba.jpg" data-src="https://i.loli.net/2017/12/19/5a386ad663a0f.jpg" class="lazyload"></a></p>
<pre><code>其中OF、DF、IF、TF、SF、ZF、AF、PF和CF在8086中就已经存在，请参考相关资料。

IOPL（I/O Privilege</code></pre><p>Level）是从80286开始出现的，占2个bit表示I/O特权级，如果当前特权级小于或等于IOPL，则可以执行I/O操作，否则将出现一个保护性异常。IOPL只能由特权级为0的程序或任务来修改。</p>
<pre><code>NT（Nested</code></pre><p>Task）也是从80286开始出现的，表示嵌套任务，用于控制中断返回指令IRET，当NT=0时，用堆栈中保存的值恢复EFLAGS、CS和EIP，从而实现返回；若NT=1，则通过任务切换实现中断返回。</p>
<pre><code>下面的标志位是80386以后的CPU才有的标志。

VM（Virtual-8086</code></pre><p>mode）表示虚拟8086模式，如果VM被置位且80386已出于保护模式下，则CPU切换到虚拟8086模式，此时，对段的任何操作又回到了实模式，如同在8086下运行一样。</p>
<pre><code>RF（Resume</code></pre><p>flag）表示恢复标志(也叫重启标志)，与调试寄存器一起用于断点和单步操作，当RF＝1<br>时，下一条指令的任何调试故障将被忽略，不产生异常中断。当RF=0时，调试故障被接受，并产生异常中断。用于调试失败后，强迫程序恢复执行，在成功执行每条指令后，RF自动复位。</p>
<pre><code>AC（Alignment</code></pre><p>check）表示对齐检查。这个标志是80486以后的CPU才有的。当AC=1且CR0中的AM=1时，允许存储器进行地址对齐检查，若发现地址未对齐，将产生异常中断。所谓地址对齐，是指当访问一个字（2字节长）时，其地址必须是偶数（2的倍数），当访问双字（4字节长）时，其地址必须是4的倍数。</p>
<pre><code>但是只有运行在特权级3的程序才执行地址对齐检查，特权级0、1、2忽略该标志。

VIF（Virtual interrupt</code></pre><p>flag）表示虚拟中断标志。以下的三个标志是Pentium以后的CPU才有的。当VIF=1时，可以使用虚拟中断，当VIF=0时不能使用虚拟中断。该标志要和下面的VIP和CR4中的VME配合使用。</p>
<pre><code>VIP（Virtual interrupt pending</code></pre><p>flag）表示虚拟中断挂起标志。当VIP=1时，VIF有效，VIP=0时VIF无效。</p>
<pre><code>ID（Identification flag）表示鉴别标志。该标志用来只是Pentium</code></pre><p>CPU是否支持CPUID的指令。</p>
<p><a href="https://i.loli.net/2017/12/19/5a386ad878cad.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="d2d51f8cf44c9073402b4fa4de1bd344.png" class="fancybox"><img alt="d2d51f8cf44c9073402b4fa4de1bd344.png" title="d2d51f8cf44c9073402b4fa4de1bd344.png" data-src="https://i.loli.net/2017/12/19/5a386ad878cad.png" class="lazyload"></a></p>
<p><a href="https://i.loli.net/2017/12/19/5a386ae4b7adf.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="fbe5b69d75e642200f06d86ac1d39c19.png" class="fancybox"><img alt="fbe5b69d75e642200f06d86ac1d39c19.png" title="fbe5b69d75e642200f06d86ac1d39c19.png" data-src="https://i.loli.net/2017/12/19/5a386ae4b7adf.png" class="lazyload"></a></p>
<h2 id="四、系统地址寄存器"><a href="#四、系统地址寄存器" class="headerlink" title="四、系统地址寄存器"></a>四、系统地址寄存器</h2><pre><code>80386</code></pre><p>中有4个系统表寄存器，分别是全局描述符表寄存器(GDTR)、中断描述符表寄存器(IDTR)、局部描述符表寄存器(LDTR)、任务状态寄存器(TR)。系统表寄存器用于在保护方式下，管理4<br>个系统表，由于只能在保护方式下使用，因此又称为保护方式寄存器。</p>
<p><a href="https://i.loli.net/2017/12/19/5a386daf9c07a.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="5fa78f20bd62e5c378f9b34f76273328.png" class="fancybox"><img alt="5fa78f20bd62e5c378f9b34f76273328.png" title="5fa78f20bd62e5c378f9b34f76273328.png" data-src="https://i.loli.net/2017/12/19/5a386daf9c07a.png" class="lazyload"></a></p>
<p><a href="https://i.loli.net/2017/12/19/5a386db379d3b.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="a13531212829ac5260abf241b3a82e4d.png" class="fancybox"><img alt="a13531212829ac5260abf241b3a82e4d.png" title="a13531212829ac5260abf241b3a82e4d.png" data-src="https://i.loli.net/2017/12/19/5a386db379d3b.png" class="lazyload"></a></p>
<h1 id="实模式"><a href="#实模式" class="headerlink" title="实模式"></a>实模式</h1><p><a href="https://i.loli.net/2017/12/19/5a386db662d97.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ea5b07755098e8e79357a739b6fac0b9.png" class="fancybox"><img alt="ea5b07755098e8e79357a739b6fac0b9.png" title="ea5b07755098e8e79357a739b6fac0b9.png" data-src="https://i.loli.net/2017/12/19/5a386db662d97.png" class="lazyload"></a></p>
<p>它是 Intel公司80286及以后的x86(80386,80486和80586等)兼容处理器（CPU）的一种操作模式。实模式被特殊定义为20位地址内存可访问空间上，这就意味着它的容量是2的20次幂（1M）的可访问内存空间（物理内存和BIOS-ROM），软件可通过这些地址直接访问BIOS程序和外围硬件。实模式下处理器没有硬件级的内存保护概念和多道任务的工作模式。但是为了向下兼容，所以80286及以后的x86系列兼容处理器仍然是开机启动时工作在实模式下。80186和早期的处理器仅有一种操作模式，就是后来我们所定义的实模式。实模式虽然能访问到1M的地址空间，但是由于BIOS的映射作用（即BIOS占用了部分空间地址资源），所以真正能使用的物理内存空间（内存条），也就是在640k到924k之间。1M 地址空间组成是由 16位的段地址和16位的段内偏移地址组成的。用公式表示为：<strong>物理地址=</strong>左移<strong>4</strong>位的段地址<strong>+偏移地址</strong>。</p>
<h3 id="保护模式："><a href="#保护模式：" class="headerlink" title="保护模式："></a><a href="https://baike.baidu.com/item/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener">保护模式</a>：</h3><p>寻址采用32位段和偏移量，最大<a href="https://baike.baidu.com/item/%E5%AF%BB%E5%9D%80%E7%A9%BA%E9%97%B4" target="_blank" rel="noopener">寻址空间</a>4GB，最大分段4GB<br>(Pentium<br>Pre及以后为64GB)。在保护模式下CPU可以进入虚拟8086方式，这是在保护模式下的实模式程序运行环境。</p>
<p><a href="https://i.loli.net/2017/12/19/5a386dbbb0f5a.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="a4a9ab781ca7531d32f00d7f37c3d711.png" class="fancybox"><img alt="a4a9ab781ca7531d32f00d7f37c3d711.png" title="a4a9ab781ca7531d32f00d7f37c3d711.png" data-src="https://i.loli.net/2017/12/19/5a386dbbb0f5a.png" class="lazyload"></a></p>
<p>在80286以及更高系列的PC中，即使A20<br>Gate被打开，在实模式下所能够访问的内存最大也只能为10FFEFH，尽管它们的地址总线所能够访问的能力都大大超过这个限制。为了能够访问10FFEFH以上的内存，则必须进入保护模式。</p>
<p>（286是Intel 80286的另一种叫法） 它又被称作为<strong>虚拟地址保护模式</strong>。尽管在Intel<br>80286手册中已经提出了虚地址保护模式，但实际上它只是一个指引，真正的32位地址出现在Intel<br>80386上。保护模式本身是80286及以后兼容处理器序列之后产成的一种操作模式，它具有许多特性设计为提高系统的多道任务和<strong>系统的稳定性</strong>。例如<strong>内存的保护</strong>，<strong>分页机制</strong>和<strong>硬件虚拟存储</strong>的支持。现代多数的x86处理器操作系统都运行在保护模式下，包括Linux,<br>Free BSD, 和Windows3.0（它也运行在实模式下，为了和Windows<br>2.x应用程序兼容）及以后的版本。</p>
<p><strong>实模式和保护模式的区别</strong></p>
<p>从表面上看，保护模式和实模式并没有太大的区别，二者都使用了内存段、中断和设备驱动来处理硬件，但二者有很多不同之处。我们知道，在实模式中内存被划分成段，每个段的大小为 64KB ，而这样的段地址可以用 16 位来表示。内存段的处理是通过和段寄存器相关联的内部机制来处理的，这些段寄存器（ CS 、 DS 、 SS 和ES ）的内容形成了物理地址的一部分。具体来说，最终的物理地址是由 16 位的段地址和 16 位的段内偏移地址组成的。用公式表示为：物理地址 = 左移 4 位的段地址 + 偏移地址。</p>
<p>在保护模式下，段是通过一系列被称之为 “ <strong>描述符表</strong> ” 的表所定义的。段寄存器存储的是指向这些表的指针。用于定义内存段的表有两种：全局描述符表 (GDT) 和局部描述符表** <strong>(LDT) 。 GDT 是一个段描述符数组，其中包含所有应用程序都可以使用的基本描述符。在实模式中，段长是固定的 ( 为 64KB) ，而在保护模式中，段长是可变的，其最大可达 4GB 。LDT 也是段描述符的一个数组。与 GDT 不同， LDT 是一个段，其中存放的是局部的、不需要全局共享的段描述符。每一个操作系统都必须定义一个</strong> <strong>GDT</strong> <strong>，而每一个正在运行的任务都会有一个相应的</strong> <strong>LDT</strong> <strong>。每一个描述符的长度是</strong> <strong>8</strong> **个字节，格式如图 3 所示。当段寄存器被加载的时候，段基地址就会从相应的表入口获得。描述符的内容会被存储在一个程序员不可见的影像寄存器 (shadow<br>register) 之中，以便下一次同一个段可以使用该信息而不用每次都到表中提取。物理地址由 16 位或者 32 位的偏移加上影像寄存器中的基址组成。实模式和保护模式的不同可以从下图很清楚地看出来。</p>
<p><strong>实模式地址</strong></p>
<p><a href="https://i.loli.net/2017/12/19/5a386dbe9b177.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="283ccbe56e2f203c838f1731936bfc38.jpg" class="fancybox"><img alt="283ccbe56e2f203c838f1731936bfc38.jpg" title="283ccbe56e2f203c838f1731936bfc38.jpg" data-src="https://i.loli.net/2017/12/19/5a386dbe9b177.jpg" class="lazyload"></a></p>
<p><strong>保护模式地址</strong></p>
<p><a href="https://i.loli.net/2017/12/19/5a386dc06a338.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="ca5d768386e99ceaa5930ef3c2b68b93.jpg" class="fancybox"><img alt="ca5d768386e99ceaa5930ef3c2b68b93.jpg" title="ca5d768386e99ceaa5930ef3c2b68b93.jpg" data-src="https://i.loli.net/2017/12/19/5a386dc06a338.jpg" class="lazyload"></a></p>
<p>保护模式同实模式的根本区别是进程内存受保护与否。可寻址空间的区别只是这一原因的果。实模式将整个物理内存看成分段的区域,程序代码和数据位于不同区域，系统程序和用户程序没有区别对待，而且每一个指针都是指向”实在”的物理地址。这样一来，用户程序的一个指针如果指向了系统程序区域或其他用户程序<br>区域，并改变了值，那么对于这个被修改的系统程序或用户程序，其后果就很可能是灾难性的。为了克服这种低劣的内存管理方式，处理器厂商开发出保护模式。这<br>样，物理内存地址不能直接被程序访问，程序内部的地址（虚拟地址）要由操作系统转化为物理地址去访问，程序对此一无所知。</p>
<p><a href="https://i.loli.net/2017/12/19/5a386dc411cea.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="0cf80a18ac54b1fe9e22f774ed60e4dc.png" class="fancybox"><img alt="0cf80a18ac54b1fe9e22f774ed60e4dc.png" title="0cf80a18ac54b1fe9e22f774ed60e4dc.png" data-src="https://i.loli.net/2017/12/19/5a386dc411cea.png" class="lazyload"></a></p>
<p>1、RPL 选择子当中的权限位确定的权限</p>
<p>2、CPL 特指CS中的选择子当中的权限位确定的权限</p>
<p>3、EPL EPL=Max(RPL,CPL),即RPL和CPL中数值较大的，或说权限等级较小的</p>
<p>4、DPL 描述符中的权限位确定的权限</p>
<p>5、PL 泛指以上4种特权级</p>
<p>6、任务特权 =CPL</p>
<p>7、I/O特权 由EFLAGS寄存器的位13、14确定的权限</p>
<p>8、一致代码段 一种特殊的代码段，它在CPL&gt;=DPL时允许访问</p>
<p>正常的代码段在CPL=DPL RPL&lt;=DPL时才允许访问</p>
<p><em>五、控制寄存器</em></p>
<p>80386的控制寄存器有4个，其中CR1保留以后使用，从Pentium开始，又增加了一个CR4，CR0的低16位包含了与80286的MSW一致的位定义，保持了和80286的兼容，同时也兼容了从80286开始的两条指令LMSW/SMSW，其基本定义如下：</p>
<p><a href="https://i.loli.net/2017/12/19/5a386dc5d696c.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="29800129903fc3ff4db840b72cb129be.jpg" class="fancybox"><img alt="29800129903fc3ff4db840b72cb129be.jpg" title="29800129903fc3ff4db840b72cb129be.jpg" data-src="https://i.loli.net/2017/12/19/5a386dc5d696c.jpg" class="lazyload"></a></p>
<pre><code>CR0中各位含义如下：</code></pre><ul>
<li><p>PE（Protection<br>Enable）保护模式允许，PE=0表示CPU工作在实模式，PE=1表示CPU工作在保护模式</p>
</li>
<li><p>MP（Monitor<br>Coprocessor）监控协处理器，MP=1表示协处理器在工作，MP=0表示协处理器未工作。</p>
</li>
<li><p>EM（Emulation）协处理器仿真，当MP=0，EM=1时，表示正在使用软件仿真协处理器工作。</p>
</li>
<li><p>TS（Task<br>Switched）任务转换，每当进行任务转换时，TS=1，任务转换完毕，TS=0。TS=1时不允许协处理器工作。</p>
<p>以上4个定义从80286开始，下面的2个定义从80386开始存在</p>
</li>
<li><p>ET（Extension<br>Type）处理器扩展类型，反映了所扩展的协处理器的类型，ET=0为80287，ET=1为80387。</p>
</li>
<li><p>PG（Paging）页式管理机制使能，PG=1时页式管理机制工作，否则不工作。</p>
<p>从80486开始又增加了如下位定义。</p>
</li>
<li><p>NE（Numeric<br>Error）数值异常中断控制，NE=1时，如果运行协处理器指令发生故障，则用异常中断处理，NE=0时，则用外部中断处理。</p>
</li>
<li><p>WP（Write Protect）写保护，当WP=1时，对只读页面进行写操作会产生页故障。</p>
</li>
<li><p>AM（Alignment<br>Mask）对齐标志，AM=1时，允许对齐检查，AM=0时不允许，关于对齐，在EFLAGS的AC标志时介绍过，在80486以后的CPU中，CPU进行对齐检查需要满足三个条件，AC=1、AM=1并且当前特权级为3。</p>
</li>
<li><p>NW（Not Write-through）和CD（Cache<br>Disable），这两个标志都是用来控制CPU内部的CACHE的，当NW=0且CD=0时，CACHE使能，其它的组合说起来比较复杂，如果有读者真的想搞清楚的话，可以参阅《Intel?<br>64 and IA-32 Architectures》中的“Software Developer’s Manual Volume<br>3A”这一册，在第10章对这两个标志的各种组合有比较详细的说明。</p>
</li>
</ul>
<p>CR1保留未用；CR2存放引起页故障的线性地址，只有在PG=1时，CR2才有效，当页故障处理程序被激活时，压入页故障处理程序堆栈中的错误码提供页故障的状态信息。  </p>
<p>CR3的bit12–bit31存放页目录的基地址，因为也目录总是页对齐的（一页为4K），所以页目录基地址从bit12开始就可以了。只有当CR0中的PG=1时，CR3的页目录基地址才有效。<br>    从80486开始，在CR3的低12位定义了两个控制位，如下：</p>
<ul>
<li><p>PCD（Page-level Cache<br>Disable）页CACHE禁止，当PCD=0时，页目录表进行高速缓存，PCD=1时，不进行高速缓存；该位控制PCD引脚控制外部CACHE工作还是不工作。</p>
</li>
<li><p>PWT（Page-level Writes<br>Transparent），CACHE的写入分为透写（Write-Through）和回写（Write-Back）,80486以上的CPU内部的CACHE都是透写的，但对外部CACHE而言，允许某些页是回写的，而另一些页是透写的，当PWT=1时，外部CACHE对页目录进行透写，否则进行回写；此位驱动PWT引脚以控制外部CACHE是透写还是回写。</p>
<p>CR4是从Pentium CPU开始出现的。</p>
</li>
<li><p>VME（Virtual-8086 Mode<br>Extensions）虚拟8086方式扩展，VME=1允许使用虚拟8086扩展模式，否则只能使用80386/80486的虚拟8086模式。</p>
</li>
<li><p>PVI（Protected-Mode Virtual<br>Interrupts）保护模式虚拟中断，PVI=1时，在保护模式下支持虚拟中断标志VIF(EFLAGS中)，PVI=0则不支持虚拟中断标志。</p>
</li>
<li><p>TSD（Time Stamp<br>Disable）时间戳禁止，TSD=1时，允许在特权级为0的程序中执行RDTSC指令（读时间戳计数指令），TSD=0时，允许任何特权级执行RDTSC指令。</p>
</li>
<li><p>DE（Debugging Extensions）调试扩展，</p>
</li>
<li><p>PSE（Page Size<br>Extensions）页大小扩展，PSE=1时，页大小可以扩展到2M或4M，PSE=0时，页大小只能是4K.</p>
</li>
<li><p>PAE（Physical Address<br>Extension）物理地址扩展，PAE=1时，页物理地址可以扩展到36bits以上，PAE=0时只能用32bits的物理地址。</p>
</li>
<li><p>MCE（Machine-Check<br>Enable）硬件检查使能，Pentium以后的CPU有一种硬件检测功能，MCE=1时允许使用该功能。</p>
</li>
<li><p>PGE（Page Global<br>Enable）全局页使能，PGE=1时，允许使用全局页，PGE=0时禁止使用全局页。</p>
</li>
<li><p>PCE（Performance-Monitoring Counter<br>Enable）性能监视计数器使能，当PCE=1时，允许在任何保护级下执行RDPMC指令，PCE=0时，只有特权级0的程序可以执行RDPMC指令。</p>
</li>
<li><p>OSFXSR（Operating System Support for FXSAVE and FXRSTOR instructions）</p>
</li>
<li><p>OSXMMEXCPT（Operating System Support for Unmasked SIMD Floating-Point<br>Exceptions）</p>
</li>
<li><p>VMXE（VMX-Enable Bit）VMX使能位，VMXE=1时，允许VMX操作。</p>
</li>
<li><p>SMXE（SMX-Enable Bit）SMX使能位，SMXE=1时，允许SMX操作。</p>
</li>
<li><p>OSXSAVE（XSAVE and Processor Extended States-Enable Bit）  </p>
</li>
</ul>
<p><em>六、调试寄存器</em></p>
<p>一共有8个调试寄存器DR0–DR7，DR0-DR3可以分别设置4个断点的线性地址，DR4-DR5保留未用，DR6是断点状态寄存器，DR7是断点控制寄存器（包括断点类型、断点长度，断点开放/禁止）</p>
<p>七、测试寄存器</p>
<p>一共有8个测试寄存器TR0–TR7，TR0-TR2保留，TR3-TR5用作CACHE测试，TR6为命令测试寄存器，TR7为测试数据寄存器。</p>
<p><strong>数据传送指令</strong></p>
<p><a href="https://i.loli.net/2017/12/19/5a3896eb47df2.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="0c47a83640959d7c625818e1b694e5d8.png" class="fancybox"><img alt="0c47a83640959d7c625818e1b694e5d8.png" title="0c47a83640959d7c625818e1b694e5d8.png" data-src="https://i.loli.net/2017/12/19/5a3896eb47df2.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3896eda5f2a.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ccba9090b3091d3df2a18e808da4819c.png" class="fancybox"><img alt="ccba9090b3091d3df2a18e808da4819c.png" title="ccba9090b3091d3df2a18e808da4819c.png" data-src="https://i.loli.net/2017/12/19/5a3896eda5f2a.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3896f0382d1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="9a5ce8b3ce516dd8bb9bc5135500767a.png" class="fancybox"><img alt="9a5ce8b3ce516dd8bb9bc5135500767a.png" title="9a5ce8b3ce516dd8bb9bc5135500767a.png" data-src="https://i.loli.net/2017/12/19/5a3896f0382d1.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3896f564e52.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="6beecf08059e0448b89b1da58cb89d9b.png" class="fancybox"><img alt="6beecf08059e0448b89b1da58cb89d9b.png" title="6beecf08059e0448b89b1da58cb89d9b.png" data-src="https://i.loli.net/2017/12/19/5a3896f564e52.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3896f74406e.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="68ed70d33227e087747326a980e9ac71.png" class="fancybox"><img alt="68ed70d33227e087747326a980e9ac71.png" title="68ed70d33227e087747326a980e9ac71.png" data-src="https://i.loli.net/2017/12/19/5a3896f74406e.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3896fb8cc38.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ff7c1f365ec61dce1ff59085006e4c8d.png" class="fancybox"><img alt="ff7c1f365ec61dce1ff59085006e4c8d.png" title="ff7c1f365ec61dce1ff59085006e4c8d.png" data-src="https://i.loli.net/2017/12/19/5a3896fb8cc38.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3896fd4f53c.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="d973137fc7bce212251bdef43ff1c6bd.png" class="fancybox"><img alt="d973137fc7bce212251bdef43ff1c6bd.png" title="d973137fc7bce212251bdef43ff1c6bd.png" data-src="https://i.loli.net/2017/12/19/5a3896fd4f53c.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3897002bb44.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="80ea7f2725c3c6a38f5150661f597c69.png" class="fancybox"><img alt="80ea7f2725c3c6a38f5150661f597c69.png" title="80ea7f2725c3c6a38f5150661f597c69.png" data-src="https://i.loli.net/2017/12/19/5a3897002bb44.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a389701b6d42.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="9f455c0ea3981c6c955982c39fd9af12.png" class="fancybox"><img alt="9f455c0ea3981c6c955982c39fd9af12.png" title="9f455c0ea3981c6c955982c39fd9af12.png" data-src="https://i.loli.net/2017/12/19/5a389701b6d42.png" class="lazyload"></a></p>
<p><strong>算术运算指令</strong></p>
<p><a href="https://i.loli.net/2017/12/19/5a38977bdf904.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="1f03d065699c062e4a935ff21c4ea93c.png" class="fancybox"><img alt="1f03d065699c062e4a935ff21c4ea93c.png" title="1f03d065699c062e4a935ff21c4ea93c.png" data-src="https://i.loli.net/2017/12/19/5a38977bdf904.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a38977da3458.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="d20668bdc119c5ee4413ffe57bf726f3.png" class="fancybox"><img alt="d20668bdc119c5ee4413ffe57bf726f3.png" title="d20668bdc119c5ee4413ffe57bf726f3.png" data-src="https://i.loli.net/2017/12/19/5a38977da3458.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a38977ec7cf9.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="453e1347cc9676c7d7fc30cbdb5335b9.png" class="fancybox"><img alt="453e1347cc9676c7d7fc30cbdb5335b9.png" title="453e1347cc9676c7d7fc30cbdb5335b9.png" data-src="https://i.loli.net/2017/12/19/5a38977ec7cf9.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3897804e4a4.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="97a053548fe6d902d09a54e571a82bfa.png" class="fancybox"><img alt="97a053548fe6d902d09a54e571a82bfa.png" title="97a053548fe6d902d09a54e571a82bfa.png" data-src="https://i.loli.net/2017/12/19/5a3897804e4a4.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a38978139e6e.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="060f4fb3226c2727e6a0d686454edcc6.png" class="fancybox"><img alt="060f4fb3226c2727e6a0d686454edcc6.png" title="060f4fb3226c2727e6a0d686454edcc6.png" data-src="https://i.loli.net/2017/12/19/5a38978139e6e.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a38978322a59.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="44ba5dc30cc16e227687804cd6bc42e3.png" class="fancybox"><img alt="44ba5dc30cc16e227687804cd6bc42e3.png" title="44ba5dc30cc16e227687804cd6bc42e3.png" data-src="https://i.loli.net/2017/12/19/5a38978322a59.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a38978433fe3.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ae291f4a22042cec9286e1e5e188b37c.png" class="fancybox"><img alt="ae291f4a22042cec9286e1e5e188b37c.png" title="ae291f4a22042cec9286e1e5e188b37c.png" data-src="https://i.loli.net/2017/12/19/5a38978433fe3.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a3897885ceb9.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="914d2c2494e0d9ec4a64ead1e2e2b4f6.png" class="fancybox"><img alt="914d2c2494e0d9ec4a64ead1e2e2b4f6.png" title="914d2c2494e0d9ec4a64ead1e2e2b4f6.png" data-src="https://i.loli.net/2017/12/19/5a3897885ceb9.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a38978a1893f.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="ef08185ae80a94473e79b3fd145bd0c2.png" class="fancybox"><img alt="ef08185ae80a94473e79b3fd145bd0c2.png" title="ef08185ae80a94473e79b3fd145bd0c2.png" data-src="https://i.loli.net/2017/12/19/5a38978a1893f.png" class="lazyload"></a><br><a href="https://i.loli.net/2017/12/19/5a38978af2646.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="b35e8a6208468e90fe54addc38e84f16.png" class="fancybox"><img alt="b35e8a6208468e90fe54addc38e84f16.png" title="b35e8a6208468e90fe54addc38e84f16.png" data-src="https://i.loli.net/2017/12/19/5a38978af2646.png" class="lazyload"></a></p>
<p>商和余数都放2字节</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">kabeor</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kabeor.github.io/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B3/">https://kabeor.github.io/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kabeor.github.io">K's House</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91/">逆向    </a><a class="post-meta__tags" href="/tags/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C/">漏洞银行    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B2/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.png'"><div class="label">上一篇</div><div class="prev_info"><span>漏洞银行逆向教程2</span></div></a></div><div class="next-post pull_right"><a href="/%E6%BC%8F%E6%B4%9E%E9%93%B6%E8%A1%8C%E9%80%86%E5%90%91%E6%95%99%E7%A8%8B4/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.png'"><div class="label">下一篇</div><div class="next_info"><span>漏洞银行逆向教程4</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/漏洞银行逆向教程1/" title="漏洞银行逆向教程1"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-02-04</div><div class="relatedPosts_title">漏洞银行逆向教程1</div></div></a></div><div class="relatedPosts_item"><a href="/漏洞银行逆向教程2/" title="漏洞银行逆向教程2"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-02-04</div><div class="relatedPosts_title">漏洞银行逆向教程2</div></div></a></div><div class="relatedPosts_item"><a href="/漏洞银行逆向教程4/" title="漏洞银行逆向教程4"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-02-04</div><div class="relatedPosts_title">漏洞银行逆向教程4</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'53gELcU5PPzXKUh1q21E5Nkh-gzGzoHsz',
  appKey:'pSNnuMbRDkWAE7j44yChrEce',
  placeholder:'请到 https://gitter.im/K-s-House/community 进行评论(╯‵□′)╯︵┻━┻',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By kabeor</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>