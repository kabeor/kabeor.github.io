<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>使用Frida给apk脱壳并穿透加固Hook函数 | K's House</title><meta name="description" content="使用Frida给apk脱壳并穿透加固Hook函数"><meta name="keywords" content="逆向,Android"><meta name="author" content="kabeor"><meta name="copyright" content="kabeor"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="使用Frida给apk脱壳并穿透加固Hook函数"><meta name="twitter:description" content="使用Frida给apk脱壳并穿透加固Hook函数"><meta name="twitter:image" content="https://i.loli.net/2018/07/16/5b4c6341bc8a9.png"><meta property="og:type" content="article"><meta property="og:title" content="使用Frida给apk脱壳并穿透加固Hook函数"><meta property="og:url" content="https://kabeor.github.io/%E4%BD%BF%E7%94%A8Frida%E7%BB%99apk%E8%84%B1%E5%A3%B3%E5%B9%B6%E7%A9%BF%E9%80%8F%E5%8A%A0%E5%9B%BAHook%E5%87%BD%E6%95%B0/"><meta property="og:site_name" content="K's House"><meta property="og:description" content="使用Frida给apk脱壳并穿透加固Hook函数"><meta property="og:image" content="https://i.loli.net/2018/07/16/5b4c6341bc8a9.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://kabeor.github.io/%E4%BD%BF%E7%94%A8Frida%E7%BB%99apk%E8%84%B1%E5%A3%B3%E5%B9%B6%E7%A9%BF%E9%80%8F%E5%8A%A0%E5%9B%BAHook%E5%87%BD%E6%95%B0/"><link rel="prev" title="2020网鼎杯RE WP" href="https://kabeor.github.io/2020%E7%BD%91%E9%BC%8E%E6%9D%AFRE_WP/"><link rel="next" title="Parallels安装Tools时call_tg_sync报错的修复" href="https://kabeor.github.io/Parallels%E5%AE%89%E8%A3%85Tools%E6%97%B6%20call_tg_sync%E6%8A%A5%E9%94%99%E7%9A%84%E4%BF%AE%E5%A4%8D/"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-113413523-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">K's House</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://kabeor.cn/img/avatarme.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">126</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">67</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">30</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#使用Frida给apk脱壳并穿透加固Hook函数"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">使用Frida给apk脱壳并穿透加固Hook函数</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#前言"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">前言</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#初步分析"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">初步分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#frida-dump-dex"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">frida dump dex</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#安装"><span class="toc_mobile_items-number">1.3.1.</span> <span class="toc_mobile_items-text">安装</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#frida-server"><span class="toc_mobile_items-number">1.3.2.</span> <span class="toc_mobile_items-text">frida-server</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#frida脚本"><span class="toc_mobile_items-number">1.3.3.</span> <span class="toc_mobile_items-text">frida脚本</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#抓包分析"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">抓包分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#JEB静态分析"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">JEB静态分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#编写frida脚本穿透加固-Hook-Java层函数"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">编写frida脚本穿透加固 Hook Java层函数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#注入frida-Hook脚本"><span class="toc_mobile_items-number">1.7.</span> <span class="toc_mobile_items-text">注入frida Hook脚本</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#参考"><span class="toc_mobile_items-number">1.8.</span> <span class="toc_mobile_items-text">参考</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#使用Frida给apk脱壳并穿透加固Hook函数"><span class="toc-number">1.</span> <span class="toc-text">使用Frida给apk脱壳并穿透加固Hook函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#初步分析"><span class="toc-number">1.2.</span> <span class="toc-text">初步分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#frida-dump-dex"><span class="toc-number">1.3.</span> <span class="toc-text">frida dump dex</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装"><span class="toc-number">1.3.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#frida-server"><span class="toc-number">1.3.2.</span> <span class="toc-text">frida-server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#frida脚本"><span class="toc-number">1.3.3.</span> <span class="toc-text">frida脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#抓包分析"><span class="toc-number">1.4.</span> <span class="toc-text">抓包分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JEB静态分析"><span class="toc-number">1.5.</span> <span class="toc-text">JEB静态分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编写frida脚本穿透加固-Hook-Java层函数"><span class="toc-number">1.6.</span> <span class="toc-text">编写frida脚本穿透加固 Hook Java层函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注入frida-Hook脚本"><span class="toc-number">1.7.</span> <span class="toc-text">注入frida Hook脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考"><span class="toc-number">1.8.</span> <span class="toc-text">参考</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2018/07/16/5b4c6341bc8a9.png)"><div id="post-info"><div id="post-title"><div class="posttitle">使用Frida给apk脱壳并穿透加固Hook函数</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-05-06<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-05-06</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Android/">Android</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">2k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 7 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span><span class="post-meta__separator">|</span><i class="fa fa-comments-o post-meta__icon fa-fw" aria-hidden="true"></i><span>评论数:</span><a href="/%E4%BD%BF%E7%94%A8Frida%E7%BB%99apk%E8%84%B1%E5%A3%B3%E5%B9%B6%E7%A9%BF%E9%80%8F%E5%8A%A0%E5%9B%BAHook%E5%87%BD%E6%95%B0/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/%E4%BD%BF%E7%94%A8Frida%E7%BB%99apk%E8%84%B1%E5%A3%B3%E5%B9%B6%E7%A9%BF%E9%80%8F%E5%8A%A0%E5%9B%BAHook%E5%87%BD%E6%95%B0/" itemprop="commentCount"></span></a></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="使用Frida给apk脱壳并穿透加固Hook函数"><a href="#使用Frida给apk脱壳并穿透加固Hook函数" class="headerlink" title="使用Frida给apk脱壳并穿透加固Hook函数"></a>使用Frida给apk脱壳并穿透加固Hook函数</h1><blockquote>
<p>首发于先知社区 <a href="https://xz.aliyun.com/t/7670" target="_blank" rel="noopener">https://xz.aliyun.com/t/7670</a></p>
</blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天拿到了新玩具JEB 3.17.1，想测试一下，顺便学习学习Android逆向，于是找了一个apk准备试试水，看看能不能搞到VIP。</p>
<h2 id="初步分析"><a href="#初步分析" class="headerlink" title="初步分析"></a>初步分析</h2><p>拖入jeb查看</p>
<p><a href="https://i.loli.net/2020/04/22/mjUVQg8AJbxCP9u.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://i.loli.net/2020/04/22/mjUVQg8AJbxCP9u.png" class="lazyload" title></a></p>
<p>嗯。。google一下</p>
<p><a href="https://i.loli.net/2020/04/22/YCipQE9bP7ao8T1.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt data-src="https://i.loli.net/2020/04/22/YCipQE9bP7ao8T1.png" class="lazyload" title></a></p>
<p>几维安全的壳，虚拟化很烦，也没什么好的脱壳工具，于是切换思路</p>
<p>从本质上来说，虚拟化就是自己实现了一套基本的cpu指令，通过自己的解释器解释给机器。因此想要在虚拟化之后仍然能让机器运行，当然还得还原代码给机器，只不过可能在内存中释放，加大了静态分析的难度。</p>
<p>那么直接让apk运行起来，我们去dump虚拟机自解密出来的dex不就好了么。</p>
<h2 id="frida-dump-dex"><a href="#frida-dump-dex" class="headerlink" title="frida dump dex"></a>frida dump dex</h2><p><strong>frida 是一款基于 python+javascript 的 hook 框架，可运行在 android、ios、linux、win等各个平台，主要使用的动态二进制插桩技术。</strong></p>
<p>总之frida是非常强大的，可以实现很多奇妙操作。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install frida</span><br></pre></td></tr></table></figure></div>

<h3 id="frida-server"><a href="#frida-server" class="headerlink" title="frida-server"></a>frida-server</h3><p><a href="https://github.com/frida/frida/releases" target="_blank" rel="noopener">https://github.com/frida/frida/releases</a></p>
<p>到上面链接里找到对应手机架构，与frida版本相同的frida-server</p>
<p>移动frida-server到安卓的/data/local/tmp目录</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./adb push frida-server /data/<span class="built_in">local</span>/tmp</span><br><span class="line">./adb <span class="built_in">kill</span>-server &amp;&amp; ./adb server &amp;&amp; ./adb shell    <span class="comment"># 这里我用了mumu模拟器，其他虚拟机连接adb方法请自行查询</span></span><br><span class="line"><span class="built_in">cd</span> /data/<span class="built_in">local</span>/tmp</span><br><span class="line">chmod 777 frida-server</span><br><span class="line">./frida-server   <span class="comment">#开始你的炸弹秀</span></span><br></pre></td></tr></table></figure></div>

<h3 id="frida脚本"><a href="#frida脚本" class="headerlink" title="frida脚本"></a>frida脚本</h3><p>这里使用了FRIDA-DEXDump  <a href="https://github.com/hluwa/FRIDA-DEXDump" target="_blank" rel="noopener">https://github.com/hluwa/FRIDA-DEXDump</a></p>
<p>其原理就是在内存中检索dex035头并获取dex长度，然后提取出来。当然，这样做会将内存中所有的dex包都提取出来，具体哪个才是我们需要的得根据包名判断并静态分析查看。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 ./main.py</span><br></pre></td></tr></table></figure></div>

<p>这里我成功提取到了无壳dex，包名都比较清晰</p>
<p><a href="https://i.loli.net/2020/04/23/COexGPwpFHWBmDu.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="COexGPwpFHWBmDu" class="fancybox"><img alt="COexGPwpFHWBmDu" data-src="https://i.loli.net/2020/04/23/COexGPwpFHWBmDu.png" class="lazyload" title="COexGPwpFHWBmDu"></a></p>
<h2 id="抓包分析"><a href="#抓包分析" class="headerlink" title="抓包分析"></a>抓包分析</h2><p>既然壳不好脱而且脱下来的又不容易修复，就考虑先看看封包里有没有VIP数据</p>
<p>使用HttpCanary对apk进行抓包</p>
<p>抓到了一个登陆验证包</p>
<p><a href="https://i.loli.net/2020/04/23/iqksg3QnvRawPCd.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="iqksg3QnvRawPCd" class="fancybox"><img alt="iqksg3QnvRawPCd" data-src="https://i.loli.net/2020/04/23/iqksg3QnvRawPCd.png" class="lazyload" title="iqksg3QnvRawPCd"></a></p>
<p>但响应里没有我们想要的信息，只是一个随时变动的值而已</p>
<p><a href="https://i.loli.net/2020/04/23/GRl1WQPuypFAgzf.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="GRl1WQPuypFAgzf" class="fancybox"><img alt="GRl1WQPuypFAgzf" data-src="https://i.loli.net/2020/04/23/GRl1WQPuypFAgzf.png" class="lazyload" title="GRl1WQPuypFAgzf"></a></p>
<p>看来抓包这条路走不通了，我们接下来只能分析拿到的dex。</p>
<h2 id="JEB静态分析"><a href="#JEB静态分析" class="headerlink" title="JEB静态分析"></a>JEB静态分析</h2><p>我们使用JEB来分析我们拿到的dex，查看包的层级数，定位到目标apk的包名，这里的命名都很清晰，直接按单词分析即可。</p>
<p><a href="https://i.loli.net/2020/04/23/YTpuncoBO3jAqC8.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="YTpuncoBO3jAqC8" class="fancybox"><img alt="YTpuncoBO3jAqC8" data-src="https://i.loli.net/2020/04/23/YTpuncoBO3jAqC8.png" class="lazyload" title="YTpuncoBO3jAqC8"></a></p>
<p>我这次用来当例子的是一个类似抖音快手的app，有视频和直播两个Activity，视频每天只能看十个（最坑的是重复点十次也算），然后就要求充值VIP，用户进入后可以不登录，会自动生成一个ID，且读取系统信息作为认证，所以重复的卸载安装当然是绕不过次数限制的。</p>
<p><strong>所以我们的目标就是通过frida hook函数使我们绕过限制，成为VIP。</strong></p>
<p>查看原apk文件的Manifest</p>
<p><a href="https://i.loli.net/2020/04/23/EZLfW1I9vjiesnl.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="EZLfW1I9vjiesnl" class="fancybox"><img alt="EZLfW1I9vjiesnl" data-src="https://i.loli.net/2020/04/23/EZLfW1I9vjiesnl.png" class="lazyload" title="EZLfW1I9vjiesnl"></a></p>
<p>这个权限它就离谱。。。</p>
<p>我们来看Activity的启动顺序</p>
<p><a href="https://i.loli.net/2020/04/23/IKGQzoLTsx2pfOq.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="IKGQzoLTsx2pfOq" class="fancybox"><img alt="IKGQzoLTsx2pfOq" data-src="https://i.loli.net/2020/04/23/IKGQzoLTsx2pfOq.png" class="lazyload" title="IKGQzoLTsx2pfOq"></a></p>
<p>先来了一个开屏广告SplashActivity，然后加载Main和Live顺便走一遍登录注册。</p>
<p>一般判断用户是否是VIP，可能存在多处判断，这样的话我们hook的点会量很大，而且可能存在漏掉的情况，因此去找变量最初赋值的位置来hook是从源头上控制了数据，而且前面封包分析发现用户数据请求发送后给我们的响应不包含VIP确认数据，因此可以说是万无一失。</p>
<p>回到层级目录分析，我们发现video/bean这个包里有我们感兴趣的东西，应该是包含了短视频相关数据。</p>
<p><a href="https://i.loli.net/2020/04/23/Gn3sh2xAdKYcP4k.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="Gn3sh2xAdKYcP4k" class="fancybox"><img alt="Gn3sh2xAdKYcP4k" data-src="https://i.loli.net/2020/04/23/Gn3sh2xAdKYcP4k.png" class="lazyload" title="Gn3sh2xAdKYcP4k"></a></p>
<p>查看TouseinfoBean这个类</p>
<p><a href="https://i.loli.net/2020/04/23/n9dzGQ7D8mLMXuR.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="n9dzGQ7D8mLMXuR" class="fancybox"><img alt="n9dzGQ7D8mLMXuR" data-src="https://i.loli.net/2020/04/23/n9dzGQ7D8mLMXuR.png" class="lazyload" title="n9dzGQ7D8mLMXuR"></a></p>
<p>我们发现这里应该包含了用户数据，修改此处就可以了。</p>
<p>但事情没有那么简单，通过交叉引用我们发现这个类根本没有被实例化（<del>可能是写着写着忘了又重新写了一个用户管理模块？？？</del>）</p>
<p>搜索字符串后并没有什么有用的发现，分析良久才想到从包层级列表搜索方法，豁然开朗（还是太菜）。</p>
<p><a href="https://i.loli.net/2020/04/23/LrMbjGgkuPXcaSF.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="LrMbjGgkuPXcaSF" class="fancybox"><img alt="LrMbjGgkuPXcaSF" data-src="https://i.loli.net/2020/04/23/LrMbjGgkuPXcaSF.png" class="lazyload" title="LrMbjGgkuPXcaSF"></a></p>
<p>嗯。。原来把直播和视频的vip管理合并到一个包了。</p>
<p>com.xxx.bean下有二十多个类，只能一个一个分析了，最后发现了几个有用的类</p>
<p><a href="https://i.loli.net/2020/04/23/8ByDikm9ECpqSub.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="8ByDikm9ECpqSub" class="fancybox"><img alt="8ByDikm9ECpqSub" data-src="https://i.loli.net/2020/04/23/8ByDikm9ECpqSub.png" class="lazyload" title="8ByDikm9ECpqSub"></a></p>
<p>其中UserBean用来管理用户信息，评论，VIP相关等等，UserLevelBean管理用户经验之类的信息。</p>
<p>UserBean类中以下三个方法是我们的Hook点</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JSONField</span>(name = <span class="string">"vvLevel"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getVVLevel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.vvLevel;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@JSONField</span>(name = <span class="string">"isVV"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isVV</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.isVV;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLevel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.level == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.level = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.level;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="编写frida脚本穿透加固-Hook-Java层函数"><a href="#编写frida脚本穿透加固-Hook-Java层函数" class="headerlink" title="编写frida脚本穿透加固 Hook Java层函数"></a>编写frida脚本穿透加固 Hook Java层函数</h2><p>没有加固的apk，一般来说直接改smali重新打包就行，而像我们现在遇到的壳，修复dex打包是一件很费力的事情，在这里frida的强大就体现出来了。</p>
<p><a href="https://bbs.pediy.com/thread-246767.htm" target="_blank" rel="noopener">使用frida来hook加固的Android应用的java层</a> 的原理可以看这里，简单来说就是拿到加载应用本身dex的classloader，通过这个classloader去找到被加固的类，通过这个类去Hook需要Hook的方法。</p>
<p>因此要穿透加固 Hook Java层函数的jscode模版如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(Java.available) &#123;</span><br><span class="line">    Java.perform(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> application = Java.use(<span class="string">"android.app.Application"</span>);</span><br><span class="line"> </span><br><span class="line">        application.attach.overload(<span class="string">'android.content.Context'</span>).implementation = <span class="function"><span class="keyword">function</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">this</span>.attach(context); <span class="comment">// 先执行原来的attach方法</span></span><br><span class="line">            <span class="keyword">var</span> classloader = context.getClassLoader(); <span class="comment">// 获取classloader</span></span><br><span class="line">            Java.classFactory.loader = classloader;</span><br><span class="line">            <span class="keyword">var</span> Hook_class = Java.classFactory.use(<span class="string">"com.xxx.类名"</span>); </span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"Hook_class: "</span> + Hook_class);</span><br><span class="line">            <span class="comment">// 下面代码和写正常的hook一样</span></span><br><span class="line">            Hook_class.方法名.implementation = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) 	// 有参数填参数		   </span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">				<span class="comment">//要执行的操作</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>根据上面对Hook点的分析，我们可以写出以下jscode</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(Java.available) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ok111'</span>);</span><br><span class="line">	Java.perform(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">var</span> application = Java.use(<span class="string">"android.app.Application"</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'ok222'</span>);</span><br><span class="line">		application.attach.overload(<span class="string">'android.content.Context'</span>).implementation = <span class="function"><span class="keyword">function</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'ok333'</span>);</span><br><span class="line">			<span class="keyword">var</span> result = <span class="keyword">this</span>.attach(context); <span class="comment">// 先执行原来的attach方法</span></span><br><span class="line">			<span class="keyword">var</span> classloader = context.getClassLoader(); <span class="comment">// 获取classloader</span></span><br><span class="line">			Java.classFactory.loader = classloader;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'ok444'</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> userinfo = Java.classFactory.use(<span class="string">"com.xxx.bean.UserBean"</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"user: "</span> + userinfo);</span><br><span class="line"></span><br><span class="line">            userinfo.getLevel.implementation = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            userinfo.isVV.implementation = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            userinfo.getVVLevel.implementation = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"9"</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> result;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="注入frida-Hook脚本"><a href="#注入frida-Hook脚本" class="headerlink" title="注入frida Hook脚本"></a>注入frida Hook脚本</h2><p>frida注入脚本有两种方式，使用python作为载体，直接运行脚本即可。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">python</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> frida, sys</span><br><span class="line"> </span><br><span class="line"><span class="comment"># hook代码，采用javascript编写</span></span><br><span class="line">jscode = <span class="string">"""</span></span><br><span class="line"><span class="string">	//javascript代码</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 自定义回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span><span class="params">(message, data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">'type'</span>] == <span class="string">'send'</span>:</span><br><span class="line">        print(<span class="string">"[*] &#123;0&#125;"</span>.format(message[<span class="string">'payload'</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(message)</span><br><span class="line"> </span><br><span class="line">process = frida.get_usb_device().attach(<span class="string">'应用完整包名'</span>)</span><br><span class="line">script = process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">'message'</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line">sys.stdin.read()</span><br></pre></td></tr></table></figure></div>

<p>或者使用命令行方式，当然了，还需要安装frida-tools</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install frida-tools</span><br></pre></td></tr></table></figure></div>



<p>这里我使用命令行方式（这里有个坑，必须按我给出的顺序，不然会报错无法连接）</p>
<p>先连接adb</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;adb kill-server &amp;&amp; .&#x2F;adb server &amp;&amp; .&#x2F;adb shell            &#x2F;&#x2F; mumu模拟器连接方式，其他模拟器自行查询</span><br></pre></td></tr></table></figure></div>

<p>新开一个shell，打开tcp转发，默认为27042端口，但是有些app会检测这个端口，因此我们来自定义一个</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;adb forward tcp:1234 tcp:1234</span><br></pre></td></tr></table></figure></div>

<p>回到第一个shell，我们已经连接到了adb，直接输入</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;data&#x2F;local&#x2F;tmp&#x2F;frida-server -l 0.0.0.0:1234</span><br></pre></td></tr></table></figure></div>

<p>在第二个shell中执行注入命令</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">frida -H 127.0.0.1:1234 -f com.xxx -l hook.js</span><br></pre></td></tr></table></figure></div>

<p>成功连接后命令行有如下回显</p>
<p><a href="https://i.loli.net/2020/04/23/iDvAzXabuQlIE1R.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="iDvAzXabuQlIE1R" class="fancybox"><img alt="iDvAzXabuQlIE1R" data-src="https://i.loli.net/2020/04/23/iDvAzXabuQlIE1R.png" class="lazyload" title="iDvAzXabuQlIE1R"></a></p>
<p>输入 %resume 对应的apk自启，没有报错则成功注入</p>
<p>我这里还加了一些流程和类名的输出</p>
<p><a href="https://i.loli.net/2020/04/23/Ne8P4MaObFd3Gvt.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="Ne8P4MaObFd3Gvt" class="fancybox"><img alt="Ne8P4MaObFd3Gvt" data-src="https://i.loli.net/2020/04/23/Ne8P4MaObFd3Gvt.png" class="lazyload" title="Ne8P4MaObFd3Gvt"></a></p>
<p>测试apk，已经可以了，其他功能思路差不多，Hook就行。</p>
<p><a href="https://i.loli.net/2020/04/23/WeiPtSmCyXguKsh.png" target="_blank" rel="noopener" data-fancybox="group" data-caption="WeiPtSmCyXguKsh" class="fancybox"><img alt="WeiPtSmCyXguKsh" data-src="https://i.loli.net/2020/04/23/WeiPtSmCyXguKsh.png" class="lazyload" title="WeiPtSmCyXguKsh"></a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://bbs.pediy.com/thread-246767.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-246767.htm</a></p>
<p><a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwih5Ja1rv7oAhW0IaYKHegbDKkQrAIoADAAegQIARAI&amp;url=https%3A%2F%2Fbbs.pediy.com%2Fthread-249602.htm&amp;usg=AOvVaw1NsItIh36jELfizdNiiAdL" target="_blank" rel="noopener">https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwih5Ja1rv7oAhW0IaYKHegbDKkQrAIoADAAegQIARAI&amp;url=https%3A%2F%2Fbbs.pediy.com%2Fthread-249602.htm&amp;usg=AOvVaw1NsItIh36jELfizdNiiAdL</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">kabeor</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kabeor.github.io/%E4%BD%BF%E7%94%A8Frida%E7%BB%99apk%E8%84%B1%E5%A3%B3%E5%B9%B6%E7%A9%BF%E9%80%8F%E5%8A%A0%E5%9B%BAHook%E5%87%BD%E6%95%B0/">https://kabeor.github.io/%E4%BD%BF%E7%94%A8Frida%E7%BB%99apk%E8%84%B1%E5%A3%B3%E5%B9%B6%E7%A9%BF%E9%80%8F%E5%8A%A0%E5%9B%BAHook%E5%87%BD%E6%95%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kabeor.github.io">K's House</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%80%86%E5%90%91/">逆向    </a><a class="post-meta__tags" href="/tags/Android/">Android    </a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2018/07/16/5b4c6341bc8a9.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020%E7%BD%91%E9%BC%8E%E6%9D%AFRE_WP/"><img class="prev_cover lazyload" data-src="https://i.loli.net/2018/07/16/5b4c6341be359.png" onerror="onerror=null;src='/img/404.png'"><div class="label">上一篇</div><div class="prev_info"><span>2020网鼎杯RE WP</span></div></a></div><div class="next-post pull_right"><a href="/Parallels%E5%AE%89%E8%A3%85Tools%E6%97%B6%20call_tg_sync%E6%8A%A5%E9%94%99%E7%9A%84%E4%BF%AE%E5%A4%8D/"><img class="next_cover lazyload" data-src="https://i.loli.net/2018/07/16/5b4c6341ac665.png" onerror="onerror=null;src='/img/404.png'"><div class="label">下一篇</div><div class="next_info"><span>Parallels安装Tools时call_tg_sync报错的修复</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/001_Acid_burn.exe 算法分析/" title="001_Acid_burn.exe 算法分析"><img class="relatedPosts_cover lazyload"data-src="https://i.loli.net/2018/07/16/5b4c62738308c.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-08-03</div><div class="relatedPosts_title">001_Acid_burn.exe 算法分析</div></div></a></div><div class="relatedPosts_item"><a href="/001_Acid_burn.exe/" title="001_Acid_burn.exe"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-07-25</div><div class="relatedPosts_title">001_Acid_burn.exe</div></div></a></div><div class="relatedPosts_item"><a href="/2018.2 MOCTFcrackme2 WriteUp/" title="2018.2 MOCTFcrackme2 WriteUp"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-07-15</div><div class="relatedPosts_title">2018.2 MOCTFcrackme2 WriteUp</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'53gELcU5PPzXKUh1q21E5Nkh-gzGzoHsz',
  appKey:'pSNnuMbRDkWAE7j44yChrEce',
  placeholder:'请到 https://gitter.im/K-s-House/community 进行评论(╯‵□′)╯︵┻━┻',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" style="background-image: url(https://i.loli.net/2018/07/16/5b4c6341bc8a9.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By kabeor</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>