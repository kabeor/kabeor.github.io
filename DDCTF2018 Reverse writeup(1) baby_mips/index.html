<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>DDCTF2018 Reverse writeup(1) baby_mips | K's House</title><meta name="description" content="DDCTF2018 Reverse writeup(1) baby_mips"><meta name="keywords" content="writeup,DDCTF2018,Reverse"><meta name="author" content="kabeor"><meta name="copyright" content="kabeor"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="DDCTF2018 Reverse writeup(1) baby_mips"><meta name="twitter:description" content="DDCTF2018 Reverse writeup(1) baby_mips"><meta name="twitter:image" content="https://i.loli.net/2018/07/16/5b4c62737e8f2.png"><meta property="og:type" content="article"><meta property="og:title" content="DDCTF2018 Reverse writeup(1) baby_mips"><meta property="og:url" content="https://kabeor.github.io/DDCTF2018%20Reverse%20writeup(1)%20baby_mips/"><meta property="og:site_name" content="K's House"><meta property="og:description" content="DDCTF2018 Reverse writeup(1) baby_mips"><meta property="og:image" content="https://i.loli.net/2018/07/16/5b4c62737e8f2.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://kabeor.github.io/DDCTF2018%20Reverse%20writeup(1)%20baby_mips/"><link rel="prev" title="DDCTF2018 MISC writeup" href="https://kabeor.github.io/DDCTF2018%20MISC%20writeup/"><link rel="next" title="Miss You" href="https://kabeor.github.io/Miss%20You/"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-113413523-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">K's House</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://kabeor.cn/img/avatarme.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">124</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">65</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">29</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#DDCTF2018-Reverse-writeup"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">DDCTF2018 Reverse writeup</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#baby-mips"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">baby_mips</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#初步尝试"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">初步尝试</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#IDA分析"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">IDA分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#使用qemu模拟器动态调试"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">使用qemu模拟器动态调试</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#使用脚本去除EB02指令"><span class="toc_mobile_items-number">1.1.4.</span> <span class="toc_mobile_items-text">使用脚本去除EB02指令</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#将数据转为代码和函数"><span class="toc_mobile_items-number">1.1.5.</span> <span class="toc_mobile_items-text">将数据转为代码和函数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#算法分析"><span class="toc_mobile_items-number">1.1.6.</span> <span class="toc_mobile_items-text">算法分析</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-反编译器分析"><span class="toc_mobile_items-number">1.1.6.1.</span> <span class="toc_mobile_items-text">1.反编译器分析</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#1-Retdec"><span class="toc_mobile_items-number">1.1.6.1.1.</span> <span class="toc_mobile_items-text">1.Retdec</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#2-JEB-MIPS"><span class="toc_mobile_items-number">1.1.6.1.2.</span> <span class="toc_mobile_items-text">2.JEB-MIPS</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-手工分析清洗方程"><span class="toc_mobile_items-number">1.1.6.2.</span> <span class="toc_mobile_items-text">2.手工分析清洗方程</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#解方程"><span class="toc_mobile_items-number">1.1.7.</span> <span class="toc_mobile_items-text">解方程</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#numpy求解"><span class="toc_mobile_items-number">1.1.7.1.</span> <span class="toc_mobile_items-text">numpy求解</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#Z3约束器求解方程"><span class="toc_mobile_items-number">1.1.7.2.</span> <span class="toc_mobile_items-text">Z3约束器求解方程</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#angr二进制自动化分析及符号执行"><span class="toc_mobile_items-number">1.1.8.</span> <span class="toc_mobile_items-text">angr二进制自动化分析及符号执行</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Flag"><span class="toc_mobile_items-number">1.1.9.</span> <span class="toc_mobile_items-text">Flag</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DDCTF2018-Reverse-writeup"><span class="toc-number">1.</span> <span class="toc-text">DDCTF2018 Reverse writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#baby-mips"><span class="toc-number">1.1.</span> <span class="toc-text">baby_mips</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#初步尝试"><span class="toc-number">1.1.1.</span> <span class="toc-text">初步尝试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDA分析"><span class="toc-number">1.1.2.</span> <span class="toc-text">IDA分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用qemu模拟器动态调试"><span class="toc-number">1.1.3.</span> <span class="toc-text">使用qemu模拟器动态调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用脚本去除EB02指令"><span class="toc-number">1.1.4.</span> <span class="toc-text">使用脚本去除EB02指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#将数据转为代码和函数"><span class="toc-number">1.1.5.</span> <span class="toc-text">将数据转为代码和函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法分析"><span class="toc-number">1.1.6.</span> <span class="toc-text">算法分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-反编译器分析"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">1.反编译器分析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-Retdec"><span class="toc-number">1.1.6.1.1.</span> <span class="toc-text">1.Retdec</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-JEB-MIPS"><span class="toc-number">1.1.6.1.2.</span> <span class="toc-text">2.JEB-MIPS</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-手工分析清洗方程"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">2.手工分析清洗方程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解方程"><span class="toc-number">1.1.7.</span> <span class="toc-text">解方程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#numpy求解"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">numpy求解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Z3约束器求解方程"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">Z3约束器求解方程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#angr二进制自动化分析及符号执行"><span class="toc-number">1.1.8.</span> <span class="toc-text">angr二进制自动化分析及符号执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag"><span class="toc-number">1.1.9.</span> <span class="toc-text">Flag</span></a></li></ol></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2018/07/16/5b4c62737e8f2.png)"><div id="post-info"><div id="post-title"><div class="posttitle">DDCTF2018 Reverse writeup(1) baby_mips</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2018-07-16<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-16</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E9%80%86%E5%90%91/">逆向</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">6.5k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 33 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="DDCTF2018-Reverse-writeup"><a href="#DDCTF2018-Reverse-writeup" class="headerlink" title="DDCTF2018 Reverse writeup"></a>DDCTF2018 Reverse writeup</h1><h2 id="baby-mips"><a href="#baby-mips" class="headerlink" title="baby_mips"></a>baby_mips</h2><p>花了一天，终于写完了</p>
<p>这是一道mips指令集的逆向题。<br>关于mips架构  <a href="https://zh.wikipedia.org/wiki/MIPS%E6%9E%B6%E6%A7%8B" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/MIPS%E6%9E%B6%E6%A7%8B</a></p>
<h3 id="初步尝试"><a href="#初步尝试" class="headerlink" title="初步尝试"></a>初步尝试</h3><p>在ubuntu运行<br><code>./baby_mips</code></p>
<p>会让输入16个值,然后提示非法指令<br><a href="https://i.loli.net/2018/07/16/5b4c615ee4801.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615ee4801.jpg" class="lazyload"></a></p>
<p>在IDA中分析一下</p>
<h3 id="IDA分析"><a href="#IDA分析" class="headerlink" title="IDA分析"></a>IDA分析</h3><p>进入IDA首先就是搜索字符串<br>显而易见<br><a href="https://i.loli.net/2018/07/16/5b4c615f0bf91.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615f0bf91.jpg" class="lazyload"></a><br>图形化分析这里<br><a href="https://i.loli.net/2018/07/16/5b4c615f2d212.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615f2d212.jpg" class="lazyload"></a><br>可以看出是一个简单的条件判断</p>
<p>如果你以为F5看算法写脚本就结束，那就too native了</p>
<h3 id="使用qemu模拟器动态调试"><a href="#使用qemu模拟器动态调试" class="headerlink" title="使用qemu模拟器动态调试"></a>使用qemu模拟器动态调试</h3><p>baby_mips是MIPS指令集上的程序，IDA只能静态分析，不能debug。采取的方法是在linux机上安装qemu模拟器，利用qemu来运行MIPS指令程序。</p>
<p>因此，首先当然是在ubuntu上安装qemu模拟器了<br><code>sudo apt-get install qemu</code><br>就可以了</p>
<p>qemu可以模拟很多指令集<br><a href="https://i.loli.net/2018/07/16/5b4c615f4e755.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615f4e755.jpg" class="lazyload"></a></p>
<p><strong>关于用法，最简单的</strong><br><code>qemu-你需要的指令集 文件名</code></p>
<p><strong>如果要利用IDA调试(IDA远程调试)</strong><br><code>qemu-你需要的指令集 -g 端口 文件名</code><br>原理：qemu -g port指令开启一个gdbserver。port另一端可以由IDA或gdb连接调试。</p>
<p>运行以后在IDA<br><a href="https://i.loli.net/2018/07/16/5b4c615f7382c.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615f7382c.jpg" class="lazyload"></a><br>选GDB调试，点左边绿色的RUN<br><a href="https://i.loli.net/2018/07/16/5b4c615f96143.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615f96143.jpg" class="lazyload"></a><br>确定<br><a href="https://i.loli.net/2018/07/16/5b4c615fa8f78.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615fa8f78.jpg" class="lazyload"></a><br>确定<br><a href="https://i.loli.net/2018/07/16/5b4c615fbcf6a.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615fbcf6a.jpg" class="lazyload"></a></p>
<p>下面我们需要输入的是Hostname和Port，如果你是在运行qemu的系统里运行IDA，Hostname就填127.0.0.1，要是别的系统，比如你用的是虚拟机，就填运行qume的系统的IP,Port就填刚刚qemu里设置好的就行。(这些是常识了)</p>
<p>然后确认IDA就可以动态调试了</p>
<p>经过尝试，这里的baby_mips是mips小字端程序，所以我们运行指令<br><code>qemu-mipsel -g 6666 baby_mips</code><br>然后IDA点确定<br><a href="https://i.loli.net/2018/07/16/5b4c615fd14a2.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c615fd14a2.jpg" class="lazyload"></a><br><a href="https://i.loli.net/2018/07/16/5b4c617b00159.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617b00159.jpg" class="lazyload"></a><br>成功了</p>
<p>我们运行程序，输入16个数，弹出一个错<br><a href="https://i.loli.net/2018/07/16/5b4c617b26015.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617b26015.jpg" class="lazyload"></a><br><a href="https://i.loli.net/2018/07/16/5b4c617b4755e.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617b4755e.jpg" class="lazyload"></a></p>
<p>程序停在了00400430，并且这里的指令是以EB02开头的</p>
<p>往下翻翻，发现非常多的EB02，然后下面的指令就不被识别了</p>
<p><a href="https://i.loli.net/2018/07/16/5b4c617b69646.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617b69646.jpg" class="lazyload"></a></p>
<p>IDA有一个强大的插件</p>
<blockquote>
<p>keypatch —–<a href="http://www.keystone-engine.org/keypatch/" target="_blank" rel="noopener">http://www.keystone-engine.org/keypatch/</a></p>
</blockquote>
<p>可以用这个插件把第一个EB02 NOP ，然后运行的话会发现又在下一个EB02报错，所以应该就是EB02的问题了</p>
<p>至于原理，参阅了很多篇wp，大概就是</p>
<blockquote>
<p>查找lwc1指令的含义，发现是与协处理器相关的指令。通过对后面的代码块进行分析发现，后面并没有用到$f29和$t1寄存器的内容</p>
<p>指令的头两个字节为 \xEB\x02 ，且在x86指令集中 \xEB 为跳转指令。</p>
<p>把操作码反汇编成汇编代码后发现第一条指令是 jmp 0x4 ，刚好MIPS指令集每条指令大小为4字节。</p>
<p>猜测程序让我们遇到这个指令就跳转四字节</p>
</blockquote>
<p>于是现在的思路就是将所有EB02开头的指令nop</p>
<p>由于MIPS指令是定长的，均为4个字节。因此，可以在选定的代码块中，将所有以EB 02开始的4字节数据全部替换成00 00 00 00，在MIPS指令中，nop对应的机器码为00 00 00 00</p>
<p>需要固定监测指令的头部，是因为可能会误清除掉正常指令</p>
<h3 id="使用脚本去除EB02指令"><a href="#使用脚本去除EB02指令" class="headerlink" title="使用脚本去除EB02指令"></a>使用脚本去除EB02指令</h3><p>下面是各位大佬写的IDC或IDPython脚本，功能都是去除EB02指令</p>
<hr>
<p>来自‘奈沙夜影’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#include &lt;idc.idc&gt;</span><br><span class="line"></span><br><span class="line">static matchBytes(StartAddr, Match) </span><br><span class="line">&#123; </span><br><span class="line">    auto Len, i, PatSub, SrcSub; </span><br><span class="line">    Len &#x3D; strlen(Match);</span><br><span class="line"></span><br><span class="line">    while (i &lt; Len) </span><br><span class="line">    &#123; </span><br><span class="line">       PatSub &#x3D; substr(Match, i, i+1); </span><br><span class="line">       SrcSub &#x3D; form(&quot;%02X&quot;, Byte(StartAddr)); </span><br><span class="line">       SrcSub &#x3D; substr(SrcSub, i % 2, (i % 2) + 1); </span><br><span class="line"></span><br><span class="line">       if (PatSub !&#x3D; &quot;?&quot; &amp;&amp; PatSub !&#x3D; SrcSub) </span><br><span class="line">       &#123; </span><br><span class="line">        return 0; </span><br><span class="line">       &#125; </span><br><span class="line"></span><br><span class="line">       if (i % 2 &#x3D;&#x3D; 1) </span><br><span class="line">       &#123; </span><br><span class="line">        StartAddr++; </span><br><span class="line">       &#125; </span><br><span class="line">       i++; </span><br><span class="line">    &#125;</span><br><span class="line">    return 1; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">static main() </span><br><span class="line">&#123; </span><br><span class="line">   auto StartVa, SavedStartVa, StopVa, Size, i, j;</span><br><span class="line"></span><br><span class="line">    StartVa &#x3D; 0x400420; </span><br><span class="line">    StopVa &#x3D; 0x403233;</span><br><span class="line"></span><br><span class="line">    Size &#x3D; StopVa - StartVa; </span><br><span class="line">    SavedStartVa &#x3D; StartVa;</span><br><span class="line"></span><br><span class="line">    for (i &#x3D; 0; i &lt; Size&#x2F;4; i++) </span><br><span class="line">    &#123; </span><br><span class="line">       if (matchBytes(StartVa, &quot;EB02????&quot;)) </span><br><span class="line">       &#123; </span><br><span class="line">            Message(&quot;Find%x:%02x%02x%02x%02x\n&quot;, StartVa,Byte(StartVa),Byte(StartVa+1),Byte(StartVa+2),Byte(StartVa+3));</span><br><span class="line">            for (j &#x3D; 0; j &lt; 4; j++) </span><br><span class="line">            &#123; </span><br><span class="line"></span><br><span class="line">                 PatchByte(StartVa, 0x00); </span><br><span class="line">                 MakeCode(StartVa); </span><br><span class="line">                 StartVa++; </span><br><span class="line">            &#125; </span><br><span class="line">       &#125; </span><br><span class="line">        else</span><br><span class="line">            StartVa&#x3D;StartVa+4; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    AnalyzeArea(SavedStartVa, StopVa); </span><br><span class="line">    Message(&quot;Clear eb02 Opcode Ok &quot;); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<hr>
<p>来自‘逢魔安全实验室’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line">f &#x3D; open(&quot;baby_mips&quot;, &quot;rb&quot;)</span><br><span class="line">content &#x3D; f.read()</span><br><span class="line">content &#x3D; list(content)</span><br><span class="line">for x in range(0, len(content)):</span><br><span class="line">    if content[x] &#x3D;&#x3D; &quot;\xeb&quot; and content[x+1] &#x3D;&#x3D; &quot;\x02&quot; and (x%4&#x3D;&#x3D;0):</span><br><span class="line">        content[x] &#x3D; &quot;\x00&quot;</span><br><span class="line">        content[x+1] &#x3D; &quot;\x00&quot;</span><br><span class="line">        content[x+2] &#x3D; &quot;\x00&quot;</span><br><span class="line">        content[x+3] &#x3D; &quot;\x00&quot;</span><br><span class="line">content &#x3D; &quot;&quot;.join(content)</span><br><span class="line">p &#x3D; open(&quot;patch&quot;, &quot;wb&quot;)</span><br><span class="line">p.write(content)</span><br></pre></td></tr></table></figure></div>
<hr>
<p>来自‘cq674350529’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import idautils</span><br><span class="line">import idc</span><br><span class="line">import idaapi</span><br><span class="line"></span><br><span class="line">start_addr &#x3D; 0x400420</span><br><span class="line">end_addr &#x3D; 0x403234</span><br><span class="line">while start_addr &lt;&#x3D; end_addr:</span><br><span class="line">    if Byte(start_addr) &#x3D;&#x3D; 0xeb and Byte(start_addr +1) &#x3D;&#x3D; 0x2:</span><br><span class="line">        PatchByte(start_addr,0x00)</span><br><span class="line">        PatchByte(start_addr+1,0x00)</span><br><span class="line">        PatchByte(start_addr+2,0x00)</span><br><span class="line">        PatchByte(start_addr+3,0x00)</span><br><span class="line">    start_addr +&#x3D; 4</span><br></pre></td></tr></table></figure></div>
<hr>
<p>选择上述其中一个脚本，在桌面保存成一个.py或.idc文件<br>选择File-&gt;Script file或Script command</p>
<p><a href="https://i.loli.net/2018/07/16/5b4c617b7d80a.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617b7d80a.jpg" class="lazyload"></a></p>
<p>然后import导入或直接写也可以，然后RUN<br><a href="https://i.loli.net/2018/07/16/5b4c617b906bc.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617b906bc.jpg" class="lazyload"></a></p>
<p>关闭这个窗口，会有一个提示是否保存修改，点击Yes，这时桌面会生成一个patch<br><a href="https://i.loli.net/2018/07/16/5b4c617ba424b.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617ba424b.jpg" class="lazyload"></a></p>
<p>IDA载入这个patch，可以发现在ubuntu下的IDA里指令都可以被识别，而且可以运行，我在win10运行的IDA会有几个小段不能识别，需要手动改为指令，将0x400420处的代码转换成函数</p>
<h3 id="将数据转为代码和函数"><a href="#将数据转为代码和函数" class="headerlink" title="将数据转为代码和函数"></a>将数据转为代码和函数</h3><p>首先往下看看，有几段没有识别的<br><a href="https://i.loli.net/2018/07/16/5b4c617bb9aa6.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617bb9aa6.jpg" class="lazyload"></a><br>把它们全部选中(00401A58-00401F28)，右键,选择Analyze selected area或按C，<br><a href="https://i.loli.net/2018/07/16/5b4c617bce1a2.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c617bce1a2.jpg" class="lazyload"></a><br>选Analyze，然后Yes，然后就会变成代码<br><a href="https://i.loli.net/2018/07/16/5b4c618e6b9a9.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618e6b9a9.jpg" class="lazyload"></a><br>当然这还没完，函数头部00400420没有变量声明，识别出来的肯定是错误的函数，因此在00400420右键，选择Create function<br><a href="https://i.loli.net/2018/07/16/5b4c618e978db.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618e978db.jpg" class="lazyload"></a><br>就可以了<br>然后图形化分析就像下面那样</p>
<p><strong>记得保存修改，路径Edit-&gt;Patch program-&gt;Apply patches input file</strong></p>
<blockquote>
<p><strong>标准转换方式</strong></p>
<p>1.<em>函数和数据互换</em></p>
<p>在重新格式化之前，首先必须删除其当前的格式（代码或数据）。右击你希望取消定义的项目，在结果上下文菜单中选择Undefine（也可使用Edit▶Undefine命令或热键U），即可取消函数、代码或数据的定义</p>
<p>转换成code后，此时不能使用图形view<br>创建函数（Edit—&gt;Functions—&gt;Create Function….）就可以了</p>
<p>2.<em>代码和数据转换</em></p>
<p>通过Edit▶Data和热键D来完成,之后使用Undefine<br>之后使用code指令</p>
</blockquote>
<h3 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h3><h4 id="1-反编译器分析"><a href="#1-反编译器分析" class="headerlink" title="1.反编译器分析"></a>1.反编译器分析</h4><p>用图形化分析sub_400420这个函数<br><a href="https://i.loli.net/2018/07/16/5b4c618eac743.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618eac743.jpg" class="lazyload"></a><br>一共十六个条件，必须每条都得满足才行</p>
<p>IDA的F5不能用，我们需要能够分析MIPS的反编译器<br>· <strong>Retdec</strong>     <a href="https://github.com/avast-tl/retdec" target="_blank" rel="noopener">https://github.com/avast-tl/retdec</a><br>· <strong>JEB-MIPS</strong>   <a href="https://www.pnfsoftware.com/jeb/demomips" target="_blank" rel="noopener">https://www.pnfsoftware.com/jeb/demomips</a></p>
<p>下面是三种找出算法的方法</p>
<h5 id="1-Retdec"><a href="#1-Retdec" class="headerlink" title="1.Retdec"></a>1.Retdec</h5><p>RetDec 是一个可重定向的机器码反编译器，它基于 LLVM，支持各种体系结构、操作系统和文件格式：<br>支持的文件格式：ELF，PE，Mach-O，COFF，AR（存档），Intel HEX 和原始机器码。<br>支持的体系结构（仅限 32 位）：Intel x86，ARM，MIPS，PIC32 和 PowerPC。</p>
<p>安装和使用方法GitHub上都写了<br>或者这里有一个很好的简易介绍  <a href="https://firmianay.gitbooks.io/ctf-all-in-one/content/doc/5.11.1_retdec.html" target="_blank" rel="noopener">https://firmianay.gitbooks.io/ctf-all-in-one/content/doc/5.11.1_retdec.html</a></p>
<p>我在win10安装之后，把patch放到了D盘根目录，Retdec文件夹也是，然后在cmd中执行<br><code>D:\retdec\bin\decompile.sh D:\patch</code><br>等待分析(因为我装了Git，就自动调用Git bash执行了，其他情况还没试过)<br>结束后D盘生成下面几个文件<br><a href="https://i.loli.net/2018/07/16/5b4c618ec9bd3.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618ec9bd3.jpg" class="lazyload"></a><br>打开patch.c，看sub_400420<br>我的不知道出了什么问题，分析不了，直接return 1。。。感觉应该是把函数分解了</p>
<p><a href="https://i.loli.net/2018/07/16/5b4c618ee2755.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618ee2755.jpg" class="lazyload"></a></p>
<p>借用一下‘niuwuwu’的图<br><a href="https://i.loli.net/2018/07/16/5b4c618f05c61.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618f05c61.jpg" class="lazyload"></a></p>
<p>是16个方程求解，解方程下面说，接下来用JEB反编译</p>
<h5 id="2-JEB-MIPS"><a href="#2-JEB-MIPS" class="headerlink" title="2.JEB-MIPS"></a>2.JEB-MIPS</h5><p>先到官网下载试用版的JEB，试用版功能是完整版的百分之九十，所以其实足够学习用了(国外友人客服也非常专业且友好)</p>
<p>解压后有三个运行脚本，分别是Windows，Linux和Mac OS的，我为了方便就装Ubuntu了</p>
<p><strong>不管是哪个系统，我们都需要JAVA8的环境</strong></p>
<p>Ubuntu安装JAVA8<br><code>sudo apt-get install openjdk-8-jdk</code><br>查看java版本，看看是否安装成功<br><code>java -version</code></p>
<p>成功后运行脚本，就打开主程序了，导入patch程序，找到00400420<br><a href="https://i.loli.net/2018/07/16/5b4c618f29f4e.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618f29f4e.jpg" class="lazyload"></a><br>右键，Decompile<br><a href="https://i.loli.net/2018/07/16/5b4c618f4427c.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618f4427c.jpg" class="lazyload"></a><br>很长很长的算式，就是16个方程了</p>
<h4 id="2-手工分析清洗方程"><a href="#2-手工分析清洗方程" class="headerlink" title="2.手工分析清洗方程"></a>2.手工分析清洗方程</h4><p>(来自‘奈沙夜影’)</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">f &#x3D; open(&quot;code.txt&quot;, &quot;r&quot;)</span><br><span class="line">flower &#x3D; [&quot;slti&quot;, &quot;sdc1&quot;]</span><br><span class="line">a0 &#x3D; 0x76ff270</span><br><span class="line">v0 &#x3D; 0xd0000</span><br><span class="line">v1 &#x3D; 8</span><br><span class="line">fp &#x3D; [0 for i in range(0x500)]</span><br><span class="line">table &#x3D; [0x0, 0x42d1f0, 0x0, 0x42d1f0,</span><br><span class="line">0xa, 0xa, 0x0, 0x9,</span><br><span class="line">0x4250bc, 0x9, 0x426630, 0x42d1f0,</span><br><span class="line">0x40a3ec, 0x37343431, 0x363434, 0x0,</span><br><span class="line">0x0, 0x42d1f0, 0x0, 0x4250bc,</span><br><span class="line">0x0, 0x0, 0x425060, 0x42d1f0,</span><br><span class="line">0x403ad0, 0x0, 0x0, 0x1000,</span><br><span class="line">0x425088, 0x76fff184, 0x412fcd, 0x1,</span><br><span class="line">0x410570, 0x425190, 0x40ca48, 0x0,</span><br><span class="line">0x0, 0x42d1f0, 0x0, 0x42d1f0,</span><br><span class="line">0x425088, 0xffffffff, 0x4106c4, 0xffffffff,</span><br><span class="line">0x76fff184, 0x412fcd, 0x1, 0x42d1f0,</span><br><span class="line">0x0, 0x425088, 0x40ccac, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x42d1f0,</span><br><span class="line">0x0, 0x425190, 0x76ffeef8, 0x425190,</span><br><span class="line">0x10, 0x425088, 0x40baac, 0x42d1f0,</span><br><span class="line">0x412fcd, 0x1, 0x425088, 0x40baac,</span><br><span class="line">0x76fff184, 0x412fce, 0x40b684, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x42d1f0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x42d1f0, 0x0, 0x42d1f0,</span><br><span class="line">0x0, 0x4250bc, 0x413081, 0x9,</span><br><span class="line">0x403f24, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x42d1f0,</span><br><span class="line">0x0, 0x413078, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0xd0000, 0xf1f4,</span><br><span class="line">0xcf8, 0xf5f1, 0x7883, 0xe2c6,</span><br><span class="line">0x67, 0xeccc, 0xc630, 0xba2e,</span><br><span class="line">0x6e41, 0x641d, 0x716d, 0x4505,</span><br><span class="line">0x76fff224, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0xfffffffe, 0x0,</span><br><span class="line">0x76fff2ac, 0x412fcd, 0x1, 0x0,</span><br><span class="line">0x6, 0x7fffffff, 0x1, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0xa, 0xa, 0x425088, 0x8,</span><br><span class="line">0x7ffffff8, 0x100, 0x413f38, 0x1,</span><br><span class="line">0x413f38, 0x0, 0x2, 0x76fff0f8,</span><br><span class="line">0x0, 0x0, 0x7fffffff, 0x76fff220,</span><br><span class="line">0x405050, 0x550001, 0x0, 0x425000,</span><br><span class="line">0x0, 0x0, 0x0, 0x0,</span><br><span class="line">0x0, 0x0, 0x0, 0x76fff220,</span><br><span class="line">0x404d84, 0x42d1f0, 0x0, 0x500,</span><br><span class="line">0x5, 0x42d1f0, 0xb3b, 0x76fff224,</span><br><span class="line">0x115, 0x1a131100, 0x76fff220, 0x76fff270,</span><br><span class="line">0x76fff2ac, 0xffbecf88, 0xa, 0x405880]</span><br><span class="line">j &#x3D; 0</span><br><span class="line">functions &#x3D; 0</span><br><span class="line">for i in range(0xb4, 0x410, 4):</span><br><span class="line">    fp[i] &#x3D; table[j]</span><br><span class="line">    j +&#x3D; 1</span><br><span class="line">input &#x3D; [int(str(i)*3, 16) for i in range(16)]</span><br><span class="line">try:</span><br><span class="line">    while(True):</span><br><span class="line">        code &#x3D; f.readline()</span><br><span class="line">        if(code &#x3D;&#x3D; &quot;&quot;):</span><br><span class="line">            print(&quot;finish&quot;)</span><br><span class="line">            break</span><br><span class="line">        if(code[:3] &#x3D;&#x3D; &quot;loc&quot;):</span><br><span class="line">            # print(&quot;\n[s]:\t&quot; + code[:-1])</span><br><span class="line">            continue</span><br><span class="line">        if(code.find(&quot;nop&quot;)!&#x3D;-1):</span><br><span class="line">            continue</span><br><span class="line">        code &#x3D; code.split(&quot;$&quot;)</span><br><span class="line">        # print(code)</span><br><span class="line"></span><br><span class="line">        c &#x3D; code[0].strip()</span><br><span class="line"></span><br><span class="line">        if(c&#x3D;&#x3D;&quot;sw&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; 0x410 - int(&quot;0x&quot; + code[1].split(&quot;_&quot;)[1].split(&quot;(&quot;)[0], 16)</span><br><span class="line">            code &#x3D; (&quot;fp[&quot; + hex(n2) + &quot;] &#x3D; &quot; + n1)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;li&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[1].split(&quot;,&quot;)[1].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n2)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;lw&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            if(&quot;&quot;.join(code).find(&quot;fp&quot;)!&#x3D;-1):</span><br><span class="line">                n2 &#x3D; 0x410 - int(&quot;0x&quot; + code[1].split(&quot;_&quot;)[1].split(&quot;(&quot;)[0], 16)</span><br><span class="line">                code &#x3D; (n1 + &quot; &#x3D; fp[&quot; + hex(n2) + &quot;]&quot;)</span><br><span class="line">                # print(&quot;# &quot; + hex(fp[n2]))</span><br><span class="line">                #输出方程</span><br><span class="line">                print(&quot;0x%x*&quot;%fp[n2],end&#x3D;&#39;&#39;)</span><br><span class="line">            else:</span><br><span class="line">                # print(&quot;[c]:\t&quot; + &quot;&quot;.join(code)[:-1], &quot;v0&#x3D;%x&quot;%v0)</span><br><span class="line">                n2 &#x3D; ((v0) + int(code[1].split(&quot;,&quot;)[1].replace(&quot;(&quot;, &quot;&quot;)))&#x2F;&#x2F;4</span><br><span class="line">                code &#x3D; (n1 + &quot; &#x3D; input[&quot; + str(n2) + &quot;]&quot;)</span><br><span class="line">                print(&quot;a[%d]&quot;%n2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                # print(code)</span><br><span class="line">                # print(hex(v0))</span><br><span class="line">                # break</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;sll&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[1].split(&quot;,&quot;)[1].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n1 + &quot;&lt;&lt;&quot; + n2)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;sra&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[1].split(&quot;,&quot;)[1].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n1 + &quot;&gt;&gt;&quot; + n2)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;xori&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[1].split(&quot;,&quot;)[1].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n1 + &quot;^&quot; + n2)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;addiu&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[1].split(&quot;,&quot;)[1].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n1 + &quot;+&quot; + n2)</span><br><span class="line">            # print(&quot;+&quot;)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;mul&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[2].split(&quot;,&quot;)[0].strip()</span><br><span class="line">            n3 &#x3D; code[3].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n2 + &quot;*&quot; + n3)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;addu&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[2].split(&quot;,&quot;)[0].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n1 + &quot;+&quot; + n2)</span><br><span class="line">            print(&quot;+&quot;)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;subu&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[2].split(&quot;,&quot;)[0].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n1 + &quot;-&quot; + n2)</span><br><span class="line">            print(&quot;-&quot;)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;beq&quot;):</span><br><span class="line">            print(&quot;&#x3D;0x%x&quot;%(v0))</span><br><span class="line">            print(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;one function&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;)</span><br><span class="line">            functions +&#x3D;1</span><br><span class="line">            continue</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;negu&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[2].split(&quot;,&quot;)[0].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + &quot;-&quot; + n2)</span><br><span class="line">            print(&quot;-&quot;)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;nop&quot;):</span><br><span class="line">            continue</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;lui&quot;):</span><br><span class="line">            n1 &#x3D; code[1].split(&quot;,&quot;)[0]</span><br><span class="line">            n2 &#x3D; code[1].split(&quot;,&quot;)[1].strip()</span><br><span class="line">            code &#x3D; (n1 + &quot; &#x3D; &quot; + n2 + &quot;&lt;&lt;32&quot;)</span><br><span class="line">        elif(c&#x3D;&#x3D;&quot;move&quot; or c&#x3D;&#x3D;&quot;and&quot;):</span><br><span class="line">            continue</span><br><span class="line">        elif(c in flower):</span><br><span class="line">            # print(&quot;[f]:\t&quot; + &quot;&quot;.join(code)[:-1])</span><br><span class="line">            continue</span><br><span class="line"></span><br><span class="line">        else:</span><br><span class="line">            print(&quot;[x]:\tFind unknown code | &quot; + &quot;&quot;.join(code))</span><br><span class="line">            break</span><br><span class="line">        # print(&quot;[-]:\t&quot; + code)</span><br><span class="line">        exec(code)</span><br><span class="line">except Exception as e:</span><br><span class="line">    print(repr(e))</span><br><span class="line">    print(code)</span><br><span class="line">print(functions)</span><br><span class="line"># print(fp)</span><br></pre></td></tr></table></figure></div>

<h3 id="解方程"><a href="#解方程" class="headerlink" title="解方程"></a>解方程</h3><p>解方程的方法很多<br>比如Python的有</p>
<blockquote>
<p>Numpy 求解线性方程组<br>SciPy 求解非线性方程组<br>SymPy</p>
</blockquote>
<p>上面三个有个链接可以参照<a href="https://zhuanlan.zhihu.com/p/24893371" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/24893371</a></p>
<h4 id="numpy求解"><a href="#numpy求解" class="headerlink" title="numpy求解"></a>numpy求解</h4><p>来自‘niuwuwu’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from scipy.linalg import solve</span><br><span class="line">A&#x3D;[</span><br><span class="line">    [-56251,64497,-61787,29993,-16853,2147,-51990,-36278,-34108,-1148,1798,-43452,-16150,-56087,-17677,-41752],</span><br><span class="line">    [-39354,63754,50513,2396,-37448,43585,19468,-4688,-62869,-20663,41173,61113,30862,38224,-601,53899],</span><br><span class="line">    [26798,-58888,14929,-21751,-12385,55961,-20714,24897,40045,9805,25147,39173,-21952,-42840,37937,-8559],</span><br><span class="line">    [-2789,53359,16747,54195,-30020,39916,-32582,60338,13971,27307,-30484,47826,37554,64914,-1745,27669],</span><br><span class="line">    [40374,6523,13380,-53413,-1194,7796,-31815,-51866,-40252,-56883,57811,23278,-5785,61525,-6984,-7335],</span><br><span class="line">    [-57052,-64573,-62351,2628,21493,12939,-60006,435,15009,-4091,22743,4901,48803,-43203,5263,-32994],</span><br><span class="line">    [54760,41053,22537,-56473,46316,19787,-40180,2088,2044,26575,-5207,31098,-23838,21642,46750,13706],</span><br><span class="line">    [-40176,-43382,48718,-25423,21452,-36714,-24119,-13231,-52192,49742,54709,-32636,20233,21460,48733,15155],</span><br><span class="line">    [38446,-880,-2443,50487,-46973,-56178,-37138,-9079,-19096,-60988,-1823,-21538,43896,-4141,-19370,-47796],</span><br><span class="line">    [5176,18400,-53852,36119,-32120,47724,17154,5390,-29717,14471,8755,1432,-45518,-8148,-56623,-48254],</span><br><span class="line">    [30203,-50712,-27560,-16075,3618,590,44305,20581,33442,-7743,-43075,-16234,45723,-44899,42321,49264],</span><br><span class="line">    [42705,-32299,-19156,5594,28870,8059,58103,-60723,-32112,-7128,45985,-24915,63910,18427,-51408,22619],</span><br><span class="line">    [-57517,20738,-32286,55995,26666,37550,-51489,13733,32455,-2897,-39622,-54523,50733,-24649,-17849,-62326],</span><br><span class="line">    [-15716,-38264,64476,-37524,-61551,13536,12920,1407,-63767,-55105,-46543,-36562,-20712,2063,-6668,9074],</span><br><span class="line">    [47490,18611,52416,3107,32177,-41780,11008,7223,5652,881,26719,-28444,46077,-272,-32475,-9432],</span><br><span class="line">    [-58938,-35689,35708,44689,45902,36614,38550,731,49990,6727,61526,-35587,-39199,-43886,-56409,-25519],</span><br><span class="line">]</span><br><span class="line">B&#x3D;[-24232262,17175305,8705731,26962228,-6384428,-15459013,19554563,-188243,-19590071,-12754495,6442406,-2869966,-4805280,-18964176,8938201,3896470]</span><br><span class="line"></span><br><span class="line">a &#x3D; np.array(A)</span><br><span class="line">b &#x3D; np.array(B)</span><br><span class="line">x &#x3D;solve(a,b)</span><br><span class="line">print(x)</span><br></pre></td></tr></table></figure></div>
<hr>
<p>来自‘ljt1000’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line">A  &#x3D; &quot;-15858,-48466,32599,38605,-44159,23939,45662,9287,47754,47937,41896,51986,-26968,22561,30701,63487;&quot;</span><br><span class="line">A +&#x3D; &quot;60228,-3993,-16615,57134,-19246,-38581,40294,-44968,-28198,-58965,-39534,22458,-8828,48593,46135,23871;&quot;</span><br><span class="line">A +&#x3D; &quot;59121,42162,-65140,-3847,-23842,-47173,-39252,37804,-20964,-19217,56467,5112,9324,61729,61599,3578;&quot;</span><br><span class="line">A +&#x3D; &quot;-36731,-26147,1670,19245,26847,39911,8628,57946,-51207,63125,-21537,-9321,40745,-58129,30962,-27610;&quot;</span><br><span class="line">A +&#x3D; &quot;-63560,-53320,-34289,61060,-14289,46922,53218,36638,-61969,-33727,-4681,32423,-17044,-46689,-35443,-24156;&quot;</span><br><span class="line">A +&#x3D; &quot;-10571,-11103,51585,-24771,63730,57047,-63227,4227,-56470,-22654,-46325,62842,22480,59412,24937,62085;&quot;</span><br><span class="line">A +&#x3D; &quot;52617,-54333,61495,33704,-41733,-44527,51882,-61765,-24691,-10103,31055,61454,-59349,9812,-48848,-47279;&quot;</span><br><span class="line">A +&#x3D; &quot;-40696,-26470,54670,-23715,10008,7723,-62622,53112,31753,-5047,-48878,-58448,19875,-34944,-22161,35800;&quot;</span><br><span class="line">A +&#x3D; &quot;-23196,-43354,-58947,3384,-2426,-60194,51907,-20177,-31882,61703,42398,-4627,45749,-29203,-11139,-41301;&quot;</span><br><span class="line">A +&#x3D; &quot;-37819,-10066,-48579,-62613,-28961,40001,-37989,-27875,-20264,-33616,-5998,30740,-29594,21652,5165,51797;&quot;</span><br><span class="line">A +&#x3D; &quot;52993,62328,4196,-55719,-1917,28075,-44831,-15799,13652,-52110,-38933,62219,40030,-23815,-19505,60128;&quot;</span><br><span class="line">A +&#x3D; &quot;35796,-28033,-59250,46833,39767,-22909,5585,-42334,64787,6068,60536,-54554,22189,-49945,40846,64023;&quot;</span><br><span class="line">A +&#x3D; &quot;-18536,-35823,4253,-63956,20175,43158,30523,28298,-29564,18809,50821,-38574,3005,33408,58281,-29452;&quot;</span><br><span class="line">A +&#x3D; &quot;2848,39836,46250,24950,38512,31901,-21506,-36050,44162,41717,-36605,-26097,-38073,36024,7349,19105;&quot;</span><br><span class="line">A +&#x3D; &quot;22525,15747,63301,42436,-26106,-22761,48830,6176,-55225,-45599,-30368,50701,5775,10902,12758,-19336;&quot;</span><br><span class="line">A +&#x3D; &quot;-58450,-51156,-5460,32490,-26701,27355,34100,-14902,10736,54258,-9189,-25920,48339,-61339,61403,-30542&quot;</span><br><span class="line"></span><br><span class="line">b &#x3D; &quot;23261386,-1298872,13877344,9172342,-11622989,10343966,-9721165,-8286458,-7515929,-12609498,2179053,11137244,12446496,10255605,854242,1542147&quot;</span><br><span class="line"></span><br><span class="line">A &#x3D; np.mat(A)</span><br><span class="line">b &#x3D; np.mat(b).T</span><br><span class="line">r &#x3D; np.linalg.solve(A,b)</span><br><span class="line">print r</span><br></pre></td></tr></table></figure></div>

<h4 id="Z3约束器求解方程"><a href="#Z3约束器求解方程" class="headerlink" title="Z3约束器求解方程"></a>Z3约束器求解方程</h4><p>Z3可以说很出名了<br>这里有个教程<a href="http://ericpony.github.io/z3py-tutorial/guide-examples.htm" target="_blank" rel="noopener">http://ericpony.github.io/z3py-tutorial/guide-examples.htm</a></p>
<p>来自‘奈沙夜影’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">a &#x3D; [BitVec(&quot;a%d&quot;%i, 32) for i in range(16)]</span><br><span class="line">s &#x3D; Solver()</span><br><span class="line">s.add(0xca6a*a[0] -0xd9ee*a[1] +0xc5a7*a[2] +0x19ee*a[3] +0xb223*a[4] +0x42e4*a[5] +0xc112*a[6] -0xcf45*a[7] +0x260d*a[8] +0xd78d*a[9] +0x99cb*a[10] -0x3e58*a[11] -0x97cb*a[12] +0xfba9*a[13] -0xdc28*a[14] +0x859b*a[15]  &#x3D;&#x3D; 0xaa2ed7)</span><br><span class="line">s.add(0xf47d*a[0] +0x12d3*a[1] -0x4102*a[2] +0xcedf*a[3] -0xafcf*a[4] -0xeb20*a[5] -0x2065*a[6] +0x36d2*a[7] -0x30fc*a[8] -0x7e5c*a[9] +0xeea8*a[10] +0xd8dd*a[11] -0xae2*a[12] +0xc053*a[13] +0x5158*a[14] -0x8d42*a[15]  &#x3D;&#x3D; 0x69d32e)</span><br><span class="line">s.add(0xffff52cf*a[0] -0x4fea*a[1] +0x2075*a[2] +0x9941*a[3] -0xbd78*a[4] +0x9e58*a[5] +0x40ad*a[6] -0x8637*a[7] -0x2e08*a[8] +0x4414*a[9] +0x2748*a[10] +0x1773*a[11] +0xe414*a[12] -0x7b19*a[13] +0x6b71*a[14] -0x3dcf*a[15]  &#x3D;&#x3D; 0x3b89d9)</span><br><span class="line">s.add(0xffffedd7*a[0] -0x1df0*a[1] +0x8115*a[2] +0x54bd*a[3] -0xf2ba*a[4] +0xdbd*a[5] +0x1dcf*a[6] +0x272*a[7] -0x2fcc*a[8] -0x93d8*a[9] -0x6f6c*a[10] -0x98ff*a[11] +0x2148*a[12] -0x6be2*a[13] +0x2e56*a[14] -0x7bdf*a[15]  &#x3D;&#x3D; 0xff6a5aea)</span><br><span class="line">s.add(0xffffa8c1*a[0] +0xdc78*a[1] -0x380f*a[2] +0x33c0*a[3] -0x7252*a[4] -0xe5a9*a[5] +0x7a53*a[6] -0x4082*a[7] -0x584a*a[8] +0xc8db*a[9] +0xd941*a[10] +0x6806*a[11] -0x8b97*a[12] +0x23d4*a[13] +0xac2a*a[14] +0x20ad*a[15]  &#x3D;&#x3D; 0x953584)</span><br><span class="line">s.add(0x5bb7*a[0] -0xfdb2*a[1] +0xaaa5*a[2] -0x50a2*a[3] -0xa318*a[4] +0xbcba*a[5] -0x5e5a*a[6] +0xf650*a[7] +0x4ab6*a[8] -0x7e3a*a[9] -0x660c*a[10] +0xaed9*a[11] -0xa60f*a[12] +0xf924*a[13] -0xff1d*a[14] +0xc888*a[15]  &#x3D;&#x3D; 0xffd31341)</span><br><span class="line">s.add(0x812d*a[0] -0x402c*a[1] +0xaa99*a[2] -0x33b*a[3] +0x311b*a[4] -0xc0d1*a[5] -0xfad*a[6] -0xc1bf*a[7] -0x1560*a[8] -0x445b*a[9] -0x9b78*a[10] +0x3b94*a[11] +0x2531*a[12] -0xfb03*a[13] +0x8*a[14] +0x8721*a[15]  &#x3D;&#x3D; 0xff9a6b57)</span><br><span class="line">s.add(0x15c5*a[0] +0xb128*a[1] -0x957d*a[2] +0xdf80*a[3] +0xee68*a[4] -0x3483*a[5] -0x4b39*a[6] -0x3807*a[7] -0x4f77*a[8] +0x652f*a[9] -0x686f*a[10] -0x7fc1*a[11] -0x5d2b*a[12] -0xb326*a[13] -0xacde*a[14] +0x1f11*a[15]  &#x3D;&#x3D; 0xffd6b3d3)</span><br><span class="line">s.add(0xaf37*a[0] +0x709*a[1] +0x4a95*a[2] -0xa445*a[3] -0x4c32*a[4] -0x6e5c*a[5] -0x45a6*a[6] +0xb989*a[7] +0xf5b7*a[8] +0x3980*a[9] -0x151d*a[10] +0xaf13*a[11] +0xa134*a[12] +0x67ff*a[13] +0xce*a[14] +0x79cf*a[15]  &#x3D;&#x3D; 0xc6ea77)</span><br><span class="line">s.add(0xffff262a*a[0] +0xdf05*a[1] -0x148e*a[2] -0x4758*a[3] -0xc6b2*a[4] -0x4f94*a[5] -0xf1f4*a[6] +0xcf8*a[7] +0xf5f1*a[8] -0x7883*a[9] -0xe2c6*a[10] -0x67*a[11] +0xeccc*a[12] -0xc630*a[13] -0xba2e*a[14] -0x6e41*a[15]  &#x3D;&#x3D; 0xff1daae5)</span><br><span class="line">s.add(0xffff9be3*a[0] -0x716d*a[1] +0x4505*a[2] -0xb99d*a[3] +0x1f00*a[4] +0x72bc*a[5] -0x7ff*a[6] +0x8945*a[7] -0xcc33*a[8] -0xab8f*a[9] +0xde9e*a[10] -0x6b69*a[11] -0x6380*a[12] +0x8cee*a[13] -0x7a60*a[14] +0xbd39*a[15]  &#x3D;&#x3D; 0xff5be0b4)</span><br><span class="line">s.add(0x245e*a[0] +0xf2c4*a[1] -0xeb20*a[2] -0x31d8*a[3] -0xe329*a[4] +0xa35a*a[5] +0xaacb*a[6] +0xe24d*a[7] +0xeb33*a[8] +0xcb45*a[9] -0xdf3a*a[10] +0x27a1*a[11] +0xb775*a[12] +0x713e*a[13] +0x5946*a[14] +0xac8e*a[15]  &#x3D;&#x3D; 0x144313b)</span><br><span class="line">s.add(0x157*a[0] -0x5f9c*a[1] -0xf1e6*a[2] +0x550*a[3] -0x441b*a[4] +0x9648*a[5] +0x8a8f*a[6] +0x7d23*a[7] -0xe1b2*a[8] -0x5a46*a[9] -0x5461*a[10] +0xee5f*a[11] -0x47e6*a[12] +0xa1bf*a[13] +0x6cf0*a[14] -0x746b*a[15]  &#x3D;&#x3D; 0xffd18bd2)</span><br><span class="line">s.add(0xf81b*a[0] -0x76cb*a[1] +0x543d*a[2] -0x4a85*a[3] +0x1468*a[4] +0xd95a*a[5] +0xfbb1*a[6] +0x6275*a[7] +0x30c4*a[8] -0x9595*a[9] -0xdbff*a[10] +0x1d1d*a[11] +0xb1cf*a[12] -0xa261*a[13] +0xf38e*a[14] +0x895c*a[15]  &#x3D;&#x3D; 0xb5cb52)</span><br><span class="line">s.add(0xffff6b97*a[0] +0xd61d*a[1] +0xe843*a[2] -0x8c64*a[3] +0xda06*a[4] +0xc5ad*a[5] +0xd02a*a[6] -0x2168*a[7] +0xa89*a[8] +0x2dd*a[9] -0x80cc*a[10] -0x9340*a[11] -0x3f07*a[12] +0x4f74*a[13] +0xb834*a[14] +0x1819*a[15]  &#x3D;&#x3D; 0xa6014d)</span><br><span class="line">s.add(0x48ed*a[0] +0x2141*a[1] +0x33ff*a[2] +0x85a9*a[3] -0x1c88*a[4] +0xa7e6*a[5] -0xde06*a[6] +0xbaf6*a[7] +0xc30f*a[8] -0xada6*a[9] -0xa114*a[10] -0x86e9*a[11] +0x70f9*a[12] +0x7580*a[13] -0x51f8*a[14] -0x492f*a[15]  &#x3D;&#x3D; 0x2fde7c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(s.check()&#x3D;&#x3D;sat):</span><br><span class="line">    c &#x3D; b&#39;&#39;</span><br><span class="line">    m &#x3D; s.model()</span><br><span class="line">    for i in range(16):</span><br><span class="line">        print(&quot;a[%d]&#x3D;%d&quot;%(i, m[a[i]].as_long()))</span><br><span class="line">    for i in range(16):</span><br><span class="line">        print(chr(m[a[i]].as_long()&amp;0xff), end&#x3D;&#39;&#39;)</span><br></pre></td></tr></table></figure></div>
<hr>
<p>来自‘cq674350529’</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"></span><br><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">a &#x3D; [BitVec(&#39;a%d&#39; %i, 32) for i in xrange(16)]</span><br><span class="line"></span><br><span class="line">s &#x3D; Solver()</span><br><span class="line">s.add(0xffffc20e*a[0]-0xbd52*a[1]+0x7f57*a[2]+0x96cd*a[3]-0xac7f*a[4] +0x5d80*a[5]+0xb25e*a[6]+0x2447*a[7]+0xba8a*a[8]+0xbb41*a[9]+0xa3a8*a[10]+0xcb12*a[11]-0x6958*a[12]+0x5821*a[13]+0x77ed*a[14]+0xf7ff*a[15] &#x3D;&#x3D; 0x162f0ca )</span><br><span class="line">s.add(0xeb44*a[0]-0x0f99*a[1] - 0x40e7*a[2] +0xdf2e*a[3] -0x4b2e*a[4] -0x96b5*a[5] +0x9d66*a[6] -0xafa8*a[7] -0x6e26*a[8] -0xe655*a[9]- 0x9a6e*a[10] +0x57ba*a[11] -0x227c*a[12] +0xbdd1*a[13] +0xb437*a[14] +0x5d3f*a[15]&#x3D;&#x3D; 0xffec2e48)</span><br><span class="line">s.add(0xe6f1*a[0] +0xa4b2*a[1] -0xfe74*a[2] -0x0f07*a[3] -0x5d22*a[4] -0xb845*a[5] -0x9954*a[6] +0x93ac*a[7] -0x51e4*a[8] -0x4b11*a[9] +0xdc93*a[10] +0x13f8*a[11] +0x246c*a[12] +0xf121*a[13] +0xf09f*a[14] +0x0dfa*a[15] &#x3D;&#x3D; 0xd3c060)</span><br><span class="line">s.add(0xffff7085*a[0] -0x6623*a[1] +0x0686*a[2] +0x4b2d*a[3] +0x68df*a[4] +0x9be7*a[5] +0x21b4*a[6] +0xe25a*a[7] -0xc807*a[8] +0xf695*a[9] -0x5421*a[10] -0x2469*a[11] +0x9f29*a[12] -0xe311*a[13] +0x78f2*a[14] -0x6bda*a[15] &#x3D;&#x3D; 0x8bf576)</span><br><span class="line">s.add(0xffff07b8*a[0] -0xd048*a[1] -0x85f1*a[2] +0xee84*a[3] -0x37d1*a[4] +0xb74a*a[5] +0xcfe2*a[6]+ 0x8f1e*a[7] -0xf211*a[8] -0x83bf*a[9] -0x1249*a[10] +0x7ea7*a[11] -0x4294*a[12] -0xb661*a[13] -0x8a73*a[14] -0x5e5c*a[15] &#x3D;&#x3D; 0xff4ea5b3)</span><br><span class="line">s.add(0xffffd6b5*a[0] -0x2b5f*a[1]+ 0xc981*a[2] -0x60c3*a[3] +0xf8f2*a[4]+ 0xded7*a[5]- 0xf6fb*a[6] +0x1083*a[7]- 0xdc96*a[8]- 0x587e*a[9] -0xb4f5*a[10] +0xf57a*a[11] +0x57d0*a[12] +0xe814*a[13] +0x6169*a[14] +0xf285*a[15] &#x3D;&#x3D; 0x9dd61e)</span><br><span class="line">s.add(0xcd89*a[0] -0xd43d*a[1] +0xf037*a[2] +0x83a8*a[3] -0xa305*a[4] -0xadef*a[5] +0xcaaa*a[6] -0xf145*a[7]- 0x6073*a[8]- 0x2777*a[9] +0x794f*a[10] +0xf00e*a[11] -0xe7d5*a[12] +0x2654*a[13] -0xbed0*a[14] -0xb8af*a[15] &#x3D;&#x3D; 0xff6baab3)</span><br><span class="line">s.add(0xffff6108*a[0] -0x6766*a[1] +0xd58e*a[2] -0x5ca3*a[3] +0x2718*a[4] +0x1e2b*a[5] -0xf49e*a[6] +0xcf78*a[7] +0x7c09*a[8] -0x13b7*a[9] -0xbeee*a[10]- 0xe450*a[11] +0x4da3*a[12] -0x8880*a[13] -0x5691*a[14] +0x8bd8*a[15] &#x3D;&#x3D; 0xff818f06)</span><br><span class="line">s.add(0xffffa564*a[0] -0xa95a*a[1] -0xe643*a[2] +0x0d38*a[3] -0x097a*a[4] -0xeb22*a[5] +0xcac3*a[6] -0x4ed1*a[7] -0x7c8a*a[8] +0xf107*a[9] +0xa59e*a[10]- 0x1213*a[11] +0xb2b5*a[12] -0x7213*a[13] -0x2b83*a[14] -0xa155*a[15] &#x3D;&#x3D; 0xff8d50e7)</span><br><span class="line">s.add(0xffff6c45*a[0] -0x2752*a[1] -0xbdc3*a[2] -0xf495*a[3] -0x7121*a[4] +0x9c41*a[5] -0x9465*a[6]- 0x6ce3*a[7] -0x4f28*a[8] -0x8350*a[9] -0x176e*a[10] +0x7814*a[11] -0x739a*a[12] +0x5494*a[13] +0x142d*a[14] +0xca55*a[15] &#x3D;&#x3D; 0xff3f9826)</span><br><span class="line">s.add(0xcf01*a[0] +0xf378*a[1] +0x1064*a[2] -0xd9a7*a[3] -0x077d*a[4]+ 0x6dab*a[5] -0xaf1f*a[6]- 0x3db7*a[7] +0x3554*a[8] -0xcb8e*a[9] -0x9815*a[10]+ 0xf30b*a[11] +0x9c5e*a[12] -0x5d07*a[13] -0x4c31*a[14] +0xeae0*a[15] &#x3D;&#x3D; 0x213fed)</span><br><span class="line">s.add(0x8bd4*a[0] -0x6d81*a[1] -0xe772*a[2] +0xb6f1*a[3] +0x9b57*a[4] -0x597d*a[5] +0x15d1*a[6]- 0xa55e*a[7]+ 0xfd13*a[8]+ 0x17b4*a[9] +0xec78*a[10] -0xd51a*a[11] +0x56ad*a[12] -0xc319*a[13] +0x9f8e*a[14] +0xfa17*a[15] &#x3D;&#x3D; 0xa9f0dc)</span><br><span class="line">s.add(0xffffb798*a[0] -0x8bef*a[1] +0x109d*a[2]- 0xf9d4*a[3] +0x4ecf*a[4] +0xa896*a[5] +0x773b*a[6] +0x6e8a*a[7] -0x737c*a[8]+ 0x4979*a[9] +0xc685*a[10] -0x96ae*a[11] +0x0bbd*a[12] +0x8280*a[13] +0xe3a9*a[14] -0x730c*a[15] &#x3D;&#x3D; 0xbdeb20)</span><br><span class="line">s.add(0x0b20*a[0] +0x9b9c*a[1] +0xb4aa*a[2]+ 0x6176*a[3] +0x9670*a[4] +0x7c9d*a[5] -0x5402*a[6] -0x8cd2*a[7] +0xac82*a[8] +0xa2f5*a[9] -0x8efd*a[10] -0x65f1*a[11] -0x94b9*a[12] +0x8cb8*a[13] +0x1cb5*a[14] +0x4aa1*a[15] &#x3D;&#x3D; 0x9c7cf5)</span><br><span class="line">s.add(0x57fd*a[0] +0x3d83*a[1] +0xf745*a[2] +0xa5c4*a[3] -0x65fa*a[4] -0x58e9*a[5] +0xbebe*a[6] +0x1820*a[7] -0xd7b9*a[8] -0xb21f*a[9] -0x76a0*a[10] +0xc60d*a[11] +0x168f*a[12] +0x2a96*a[13] +0x31d6*a[14] -0x4b88*a[15] &#x3D;&#x3D; 0xd08e2)</span><br><span class="line">s.add(0xffff1bae*a[0] -0xc7d4*a[1] -0x1554*a[2] +0x7eea*a[3] -0x684d*a[4] +0x6adb*a[5] +0x8534*a[6] -0x3a36*a[7] +0x29f0*a[8] +0xd3f2*a[9] -0x23e5*a[10] -0x6540*a[11] +0xbcd3*a[12] -0xef9b*a[13] +0xefdb*a[14] -0x774e*a[15] &#x3D;&#x3D; 0x178803)</span><br><span class="line"></span><br><span class="line">for item in a:</span><br><span class="line">    s.add(item &gt; 0, item &lt; 127)</span><br><span class="line"></span><br><span class="line">if s.check() &#x3D;&#x3D; sat:</span><br><span class="line">    m &#x3D; s.model()</span><br><span class="line">    flag &#x3D; []</span><br><span class="line">    for i in xrange(16):</span><br><span class="line">        flag.append(m[a[i]].as_long())</span><br><span class="line">    print &#39;&#39;.join(map(chr, flag))</span><br></pre></td></tr></table></figure></div>

<h3 id="angr二进制自动化分析及符号执行"><a href="#angr二进制自动化分析及符号执行" class="headerlink" title="angr二进制自动化分析及符号执行"></a>angr二进制自动化分析及符号执行</h3><p>angr是一个基于python的二进制漏洞分析框架，集成了多种主流的分析技术，能够进行动态的符号执行分析和多种静态分析。</p>
<p>如果我们使用angr的话，就不再需要考虑算法内部的详细原理，利用符号执行可以大大减少分析时间</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.text:00403620                 lw      $gp, 0x98+var_50($fp)</span><br><span class="line">.text:00403624                 addiu   $v0, $fp, 0x98+var_48</span><br><span class="line">.text:00403628                 move    $a0, $v0</span><br><span class="line">.text:0040362C                 jal     sub_400420</span><br><span class="line">.text:00403630                 nop</span><br><span class="line">.text:00403634                 lw      $gp, 0x98+var_50($fp)</span><br><span class="line">.text:00403638                 beqz    $v0, loc_4036E4</span><br><span class="line">.text:0040363C                 nop</span><br></pre></td></tr></table></figure></div>

<p>通过静态分析可知，程序在0x40362c处调用sub_400420函数，其参数通过寄存器a0传递，然后返回值保存在v0寄存器中。之后对v0的内容进行判断，如果为1则输出flag(flag与用户输入的内容相关)，为0则输出”Wrong”。因此，只需要求解输入，保证sub_400420的返回值为1即可。</p>
<p>angr脚本</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class="line"></span><br><span class="line">import angr</span><br><span class="line"></span><br><span class="line">project &#x3D; angr.Project(&#39;.&#x2F;patch&#39;, load_options&#x3D;&#123;&#39;auto_load_libs&#39;:False&#125;)</span><br><span class="line"></span><br><span class="line">start_address &#x3D; 0x400420</span><br><span class="line">memory_address &#x3D; 0x10000000</span><br><span class="line"></span><br><span class="line">find_address &#x3D; 0x4031F0</span><br><span class="line">avoid_address &#x3D; (0x4019E4, 0x401b7c,0x401D18, 0x401EB0, 0x40204C, 0x4021E4, 0x40237C, 0x402518, 0x4026B4, 0x40284C, 0x4029E4, 0x402B7C, 0x402D14, 0x402EB0, 0x403048, 0x4031E0)</span><br><span class="line"></span><br><span class="line">state &#x3D; project.factory.blank_state(addr&#x3D;start_address)</span><br><span class="line"></span><br><span class="line">for i in xrange(16):</span><br><span class="line">    state.memory.store(memory_address+i*4, state.solver.BVS(&#39;a%d&#39; % i, 32), endness&#x3D;state.arch.memory_endness)</span><br><span class="line"></span><br><span class="line">state.regs.a0 &#x3D; memory_address</span><br><span class="line"></span><br><span class="line"># add LAZY_SOLVES to speed up</span><br><span class="line">simgr &#x3D; project.factory.simulation_manager(state, add_options&#x3D;&#123;angr.options.LAZY_SOLVES&#125;)</span><br><span class="line"></span><br><span class="line">simgr.explore(find&#x3D;find_address, avoid&#x3D;avoid_address)</span><br><span class="line"></span><br><span class="line">if simgr.found:</span><br><span class="line">    find_state &#x3D; simgr.found[0]</span><br><span class="line"></span><br><span class="line">    # add constraints to reduce the keyspace</span><br><span class="line">    for i in xrange(16):</span><br><span class="line">        value &#x3D; find_state.memory.load(memory_address+i*4,4, endness&#x3D;find_state.arch.memory_endness)</span><br><span class="line">        find_state.add_constraints(value &gt; 0, value &lt; 127)</span><br><span class="line"></span><br><span class="line">    flag &#x3D; [find_state.se.eval(find_state.memory.load(memory_address+i*4, 4, endness&#x3D;find_state.arch.memory_endness)) for i in xrange(16)]</span><br><span class="line">    print &#39;&#39;.join(map(chr,flag))</span><br></pre></td></tr></table></figure></div>

<p>返回1的地址<br><a href="https://i.loli.net/2018/07/16/5b4c618f5dc80.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c618f5dc80.jpg" class="lazyload"></a></p>
<p><a href="https://i.loli.net/2018/07/16/5b4c6199a3626.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c6199a3626.jpg" class="lazyload"></a><br>find_address是使得函数sub_400420返回值为1的地址，而avoid_address是使得函数sub_400420返回值为0的地址。同时，将输入的16个数字保存在内存地址0x10000000处，然后将其赋值给a0寄存器，实现参数的传递。之后，直接从函数sub_400420的开始处开始分析。</p>
<hr>
<p>第二种</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">from angr import *</span><br><span class="line">import logging</span><br><span class="line">import IPython</span><br><span class="line">logging.getLogger(&#39;angr.manager&#39;).setLevel(logging.DEBUG)</span><br><span class="line">p &#x3D; Project(&#39;baby_mips&#39;)</span><br><span class="line">state &#x3D; p.factory.blank_state(addr&#x3D;0x400420)</span><br><span class="line">DATA_ADDR &#x3D; 0xA0000</span><br><span class="line">state.regs.a0 &#x3D; DATA_ADDR</span><br><span class="line">for i in range(16*4):</span><br><span class="line">    vec &#x3D; state.solver.BVS(&quot;c&#123;&#125;&quot;.format(i),8,explicit_name&#x3D;True)</span><br><span class="line">    cond &#x3D; state.solver.And(vec&gt;&#x3D;32,vec&lt;&#x3D;126) # low byte</span><br><span class="line">    state.memory.store(DATA_ADDR+i,vec)</span><br><span class="line">    if i % 4 &#x3D;&#x3D; 0:</span><br><span class="line">        pass</span><br><span class="line">    #state.add_constraints(cond)</span><br><span class="line">sm &#x3D; p.factory.simulation_manager(state)</span><br><span class="line">res &#x3D; sm.explore(find&#x3D;0x4031F0,avoid&#x3D;[0x4019E4, 0x401b7c,0x401D18, 0x401EB0, 0x40204C, 0x4021E4, 0x40237C, 0x402518, 0x4026B4, 0x40284C, 0x4029E4, 0x402B7C, 0x402D14, 0x402EB0, 0x403048, 0x4031E0])</span><br><span class="line"></span><br><span class="line">found &#x3D; res.found[0]</span><br><span class="line">mem &#x3D; found.memory.load(DATA_ADDR,16*4)</span><br><span class="line">print found.solver.eval(mem)</span><br><span class="line">print &#39;##########################################&#39;</span><br><span class="line">flag &#x3D; &#39;&#39;</span><br><span class="line">for i in range(16):</span><br><span class="line">    v &#x3D; found.memory.load(DATA_ADDR + 4*i,1)</span><br><span class="line">    flag &#x3D; flag + found.solver.eval(v,cast_to&#x3D;str)</span><br><span class="line">print flag  #7fe2c58fc9a7eb90</span><br></pre></td></tr></table></figure></div>

<p><a href="https://i.loli.net/2018/07/16/5b4c6199c866b.jpg" target="_blank" rel="noopener" data-fancybox="group" data-caption="mark" class="fancybox"><img alt="mark" title="mark" data-src="https://i.loli.net/2018/07/16/5b4c6199c866b.jpg" class="lazyload"></a></p>
<p>flag每个人都是不一样的，我的用angr解的话，最后得到的是7fe2c58fc9a7eb90</p>
<h3 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h3><p>于是flag: DDCTF{7fe2c58fc9a7eb90}</p>
<p>z3解的话还可以得出具体每个变量的值，这里就不放图了</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">kabeor</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kabeor.github.io/DDCTF2018%20Reverse%20writeup(1)%20baby_mips/">https://kabeor.github.io/DDCTF2018%20Reverse%20writeup(1)%20baby_mips/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kabeor.github.io">K's House</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/writeup/">writeup    </a><a class="post-meta__tags" href="/tags/DDCTF2018/">DDCTF2018    </a><a class="post-meta__tags" href="/tags/Reverse/">Reverse    </a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2018/07/16/5b4c62737e8f2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/DDCTF2018%20MISC%20writeup/"><img class="prev_cover lazyload" data-src="https://i.loli.net/2018/07/16/5b4c62738308c.png" onerror="onerror=null;src='/img/404.png'"><div class="label">上一篇</div><div class="prev_info"><span>DDCTF2018 MISC writeup</span></div></a></div><div class="next-post pull_right"><a href="/Miss%20You/"><img class="next_cover lazyload" data-src="https://i.loli.net/2018/07/16/5b4c62738681b.png" onerror="onerror=null;src='/img/404.png'"><div class="label">下一篇</div><div class="next_info"><span>Miss You</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/DDCTF2018 MISC writeup/" title="DDCTF2018 MISC writeup"><img class="relatedPosts_cover lazyload"data-src="https://i.loli.net/2018/07/16/5b4c62738308c.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-07-16</div><div class="relatedPosts_title">DDCTF2018 MISC writeup</div></div></a></div><div class="relatedPosts_item"><a href="/对强网杯2018“Web签到”的思考/" title="对强网杯2018“Web签到”的思考"><img class="relatedPosts_cover lazyload"data-src="https://i.loli.net/2018/07/16/5b4c62f8f2471.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2018-07-19</div><div class="relatedPosts_title">对强网杯2018“Web签到”的思考</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = true == true ? true : false;
var verify = true == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'53gELcU5PPzXKUh1q21E5Nkh-gzGzoHsz',
  appKey:'pSNnuMbRDkWAE7j44yChrEce',
  placeholder:'都看到这里了还不评论一下吗(╯‵□′)╯︵┻━┻',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By kabeor</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>